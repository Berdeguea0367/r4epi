<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>35 Writing for loops | R for Epidemiology</title>
  <meta name="description" content="This is the textbook for Brad Cannell’s Introduction to R Programming for Epidemiologic Research course." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="35 Writing for loops | R for Epidemiology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://brad-cannell.github.io/r4epi/" />
  <meta property="og:image" content="https://brad-cannell.github.io/r4epi/r4epi_icon.png" />
  <meta property="og:description" content="This is the textbook for Brad Cannell’s Introduction to R Programming for Epidemiologic Research course." />
  <meta name="github-repo" content="brad-cannell/r4epi" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="35 Writing for loops | R for Epidemiology" />
  
  <meta name="twitter:description" content="This is the textbook for Brad Cannell’s Introduction to R Programming for Epidemiologic Research course." />
  <meta name="twitter:image" content="https://brad-cannell.github.io/r4epi/r4epi_icon.png" />

<meta name="author" content="Brad Cannell" />


<meta name="date" content="2022-01-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="column-wise-operations-in-dplyr.html"/>
<link rel="next" href="using-the-purrr-package.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.20/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0RREBTQ0D9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0RREBTQ0D9');
</script>
<!-- R4Epi Favicons -->
<!-- https://bookdown.org/yihui/rmarkdown-cookbook/favicon.html -->
<!-- Also using Favicon Generator (https://realfavicongenerator.net) -->
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Epidemiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#goals"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#text-conventions-used-in-this-book"><i class="fa fa-check"></i>Text conventions used in this book</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#other-reading"><i class="fa fa-check"></i>Other reading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="contributing-to-r4epi.html"><a href="contributing-to-r4epi.html"><i class="fa fa-check"></i>Contributing to R4Epi</a>
<ul>
<li class="chapter" data-level="" data-path="contributing-to-r4epi.html"><a href="contributing-to-r4epi.html#typos"><i class="fa fa-check"></i>Typos</a></li>
<li class="chapter" data-level="" data-path="contributing-to-r4epi.html"><a href="contributing-to-r4epi.html#issues"><i class="fa fa-check"></i>Issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a>
<ul>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html#brad-cannell"><i class="fa fa-check"></i>Brad Cannell</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html#melvin-livingston"><i class="fa fa-check"></i>Melvin Livingston</a></li>
</ul></li>
<li class="part"><span><b>I Getting Started</b></span></li>
<li class="chapter" data-level="1" data-path="installing-r-and-rstudio.html"><a href="installing-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Installing R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installing-r-and-rstudio.html"><a href="installing-r-and-rstudio.html#download-and-install-on-a-mac"><i class="fa fa-check"></i><b>1.1</b> Download and install on a Mac</a></li>
<li class="chapter" data-level="1.2" data-path="installing-r-and-rstudio.html"><a href="installing-r-and-rstudio.html#download-and-install-on-a-pc"><i class="fa fa-check"></i><b>1.2</b> Download and install on a PC</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2</b> What is R?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-r.html"><a href="what-is-r.html#what-is-data"><i class="fa fa-check"></i><b>2.1</b> What is data?</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-r.html"><a href="what-is-r.html#what-is-r-1"><i class="fa fa-check"></i><b>2.2</b> What is R?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-r.html"><a href="what-is-r.html#transferring-data"><i class="fa fa-check"></i><b>2.2.1</b> Transferring data</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-r.html"><a href="what-is-r.html#managing-data"><i class="fa fa-check"></i><b>2.2.2</b> Managing data</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-r.html"><a href="what-is-r.html#analyzing-data"><i class="fa fa-check"></i><b>2.2.3</b> Analyzing data</a></li>
<li class="chapter" data-level="2.2.4" data-path="what-is-r.html"><a href="what-is-r.html#presenting-data"><i class="fa fa-check"></i><b>2.2.4</b> Presenting data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html"><i class="fa fa-check"></i><b>3</b> Navigating the RStudio interface</a>
<ul>
<li class="chapter" data-level="3.1" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-console"><i class="fa fa-check"></i><b>3.1</b> The console</a></li>
<li class="chapter" data-level="3.2" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-environment-pane"><i class="fa fa-check"></i><b>3.2</b> The environment pane</a></li>
<li class="chapter" data-level="3.3" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-files-pane"><i class="fa fa-check"></i><b>3.3</b> The files pane</a></li>
<li class="chapter" data-level="3.4" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#the-source-pane"><i class="fa fa-check"></i><b>3.4</b> The source pane</a></li>
<li class="chapter" data-level="3.5" data-path="navigating-the-rstudio-interface.html"><a href="navigating-the-rstudio-interface.html#rstudio-preferences"><i class="fa fa-check"></i><b>3.5</b> RStudio preferences</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html"><i class="fa fa-check"></i><b>4</b> Speaking R’s language</a>
<ul>
<li class="chapter" data-level="4.1" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#r-is-a-language"><i class="fa fa-check"></i><b>4.1</b> R is a <em>language</em></a></li>
<li class="chapter" data-level="4.2" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#the-r-interpreter"><i class="fa fa-check"></i><b>4.2</b> The R interpreter</a></li>
<li class="chapter" data-level="4.3" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#errors"><i class="fa fa-check"></i><b>4.3</b> Errors</a></li>
<li class="chapter" data-level="4.4" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#functions"><i class="fa fa-check"></i><b>4.4</b> Functions</a></li>
<li class="chapter" data-level="4.5" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#objects"><i class="fa fa-check"></i><b>4.5</b> Objects</a></li>
<li class="chapter" data-level="4.6" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#comments"><i class="fa fa-check"></i><b>4.6</b> Comments</a></li>
<li class="chapter" data-level="4.7" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#packages"><i class="fa fa-check"></i><b>4.7</b> Packages</a></li>
<li class="chapter" data-level="4.8" data-path="speaking-rs-language.html"><a href="speaking-rs-language.html#programming-style"><i class="fa fa-check"></i><b>4.8</b> Programming style</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lets-get-programming.html"><a href="lets-get-programming.html"><i class="fa fa-check"></i><b>5</b> Let’s get programming</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#simulating-data"><i class="fa fa-check"></i><b>5.1</b> Simulating data</a></li>
<li class="chapter" data-level="5.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#vectors"><i class="fa fa-check"></i><b>5.2</b> Vectors</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#vector-types"><i class="fa fa-check"></i><b>5.2.1</b> Vector types</a></li>
<li class="chapter" data-level="5.2.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#double-vectors"><i class="fa fa-check"></i><b>5.2.2</b> Double vectors</a></li>
<li class="chapter" data-level="5.2.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#integer-vectors"><i class="fa fa-check"></i><b>5.2.3</b> Integer vectors</a></li>
<li class="chapter" data-level="5.2.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#logical-vectors"><i class="fa fa-check"></i><b>5.2.4</b> Logical vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#data-frames"><i class="fa fa-check"></i><b>5.3</b> Data frames</a></li>
<li class="chapter" data-level="5.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#tibbles"><i class="fa fa-check"></i><b>5.4</b> Tibbles</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-as_tibble-function"><i class="fa fa-check"></i><b>5.4.1</b> The as_tibble function</a></li>
<li class="chapter" data-level="5.4.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-tibble-function"><i class="fa fa-check"></i><b>5.4.2</b> The tibble function</a></li>
<li class="chapter" data-level="5.4.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-tribble-function"><i class="fa fa-check"></i><b>5.4.3</b> The tribble function</a></li>
<li class="chapter" data-level="5.4.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#why-use-tibbles"><i class="fa fa-check"></i><b>5.4.4</b> Why use tibbles</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="lets-get-programming.html"><a href="lets-get-programming.html#missing-data"><i class="fa fa-check"></i><b>5.5</b> Missing data</a></li>
<li class="chapter" data-level="5.6" data-path="lets-get-programming.html"><a href="lets-get-programming.html#our-first-analysis"><i class="fa fa-check"></i><b>5.6</b> Our first analysis</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="lets-get-programming.html"><a href="lets-get-programming.html#manual-calculation-of-the-mean"><i class="fa fa-check"></i><b>5.6.1</b> Manual calculation of the mean</a></li>
<li class="chapter" data-level="5.6.2" data-path="lets-get-programming.html"><a href="lets-get-programming.html#dollar-sign-notation"><i class="fa fa-check"></i><b>5.6.2</b> Dollar sign notation</a></li>
<li class="chapter" data-level="5.6.3" data-path="lets-get-programming.html"><a href="lets-get-programming.html#bracket-notation"><i class="fa fa-check"></i><b>5.6.3</b> Bracket notation</a></li>
<li class="chapter" data-level="5.6.4" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-sum-function"><i class="fa fa-check"></i><b>5.6.4</b> The sum function</a></li>
<li class="chapter" data-level="5.6.5" data-path="lets-get-programming.html"><a href="lets-get-programming.html#nesting-functions"><i class="fa fa-check"></i><b>5.6.5</b> Nesting functions</a></li>
<li class="chapter" data-level="5.6.6" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-length-function"><i class="fa fa-check"></i><b>5.6.6</b> The length function</a></li>
<li class="chapter" data-level="5.6.7" data-path="lets-get-programming.html"><a href="lets-get-programming.html#the-mean-function"><i class="fa fa-check"></i><b>5.6.7</b> The mean function</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="lets-get-programming.html"><a href="lets-get-programming.html#some-common-errors"><i class="fa fa-check"></i><b>5.7</b> Some common errors</a></li>
<li class="chapter" data-level="5.8" data-path="lets-get-programming.html"><a href="lets-get-programming.html#summary"><i class="fa fa-check"></i><b>5.8</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>II Coding Tools and Best Practices</b></span></li>
<li class="chapter" data-level="6" data-path="r-scripts.html"><a href="r-scripts.html"><i class="fa fa-check"></i><b>6</b> R scripts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="r-scripts.html"><a href="r-scripts.html#creating-r-scripts"><i class="fa fa-check"></i><b>6.1</b> Creating R scripts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>7</b> R markdown</a>
<ul>
<li class="chapter" data-level="7.1" data-path="r-markdown.html"><a href="r-markdown.html#what-is-r-markdown"><i class="fa fa-check"></i><b>7.1</b> What is R markdown?</a></li>
<li class="chapter" data-level="7.2" data-path="r-markdown.html"><a href="r-markdown.html#why-use-r-markdown"><i class="fa fa-check"></i><b>7.2</b> Why use R markdown?</a></li>
<li class="chapter" data-level="7.3" data-path="r-markdown.html"><a href="r-markdown.html#create-an-r-notebook"><i class="fa fa-check"></i><b>7.3</b> Create an R Notebook</a></li>
<li class="chapter" data-level="7.4" data-path="r-markdown.html"><a href="r-markdown.html#yaml-headers"><i class="fa fa-check"></i><b>7.4</b> YAML headers</a></li>
<li class="chapter" data-level="7.5" data-path="r-markdown.html"><a href="r-markdown.html#r-code-chunks"><i class="fa fa-check"></i><b>7.5</b> R code chunks</a></li>
<li class="chapter" data-level="7.6" data-path="r-markdown.html"><a href="r-markdown.html#markdown"><i class="fa fa-check"></i><b>7.6</b> Markdown</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="r-projects.html"><a href="r-projects.html"><i class="fa fa-check"></i><b>8</b> R projects</a></li>
<li class="chapter" data-level="9" data-path="coding-best-practices.html"><a href="coding-best-practices.html"><i class="fa fa-check"></i><b>9</b> Coding best practices</a>
<ul>
<li class="chapter" data-level="9.1" data-path="coding-best-practices.html"><a href="coding-best-practices.html#general-principles"><i class="fa fa-check"></i><b>9.1</b> General principles</a></li>
<li class="chapter" data-level="9.2" data-path="coding-best-practices.html"><a href="coding-best-practices.html#code-comments"><i class="fa fa-check"></i><b>9.2</b> Code comments</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="coding-best-practices.html"><a href="coding-best-practices.html#defining-key-variables"><i class="fa fa-check"></i><b>9.2.1</b> Defining key variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="coding-best-practices.html"><a href="coding-best-practices.html#what-this-code-is-trying-to-accomplish"><i class="fa fa-check"></i><b>9.2.2</b> What this code is trying to accomplish</a></li>
<li class="chapter" data-level="9.2.3" data-path="coding-best-practices.html"><a href="coding-best-practices.html#why-i-chose-this-particular-strategy"><i class="fa fa-check"></i><b>9.2.3</b> Why I chose this particular strategy</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="coding-best-practices.html"><a href="coding-best-practices.html#style-guidelines"><i class="fa fa-check"></i><b>9.3</b> Style guidelines</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="coding-best-practices.html"><a href="coding-best-practices.html#comments-1"><i class="fa fa-check"></i><b>9.3.1</b> Comments</a></li>
<li class="chapter" data-level="9.3.2" data-path="coding-best-practices.html"><a href="coding-best-practices.html#object-variable-names"><i class="fa fa-check"></i><b>9.3.2</b> Object (variable) names</a></li>
<li class="chapter" data-level="9.3.3" data-path="coding-best-practices.html"><a href="coding-best-practices.html#use-names-that-are-informative"><i class="fa fa-check"></i><b>9.3.3</b> Use names that are informative</a></li>
<li class="chapter" data-level="9.3.4" data-path="coding-best-practices.html"><a href="coding-best-practices.html#file-names"><i class="fa fa-check"></i><b>9.3.4</b> File Names</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-pipes.html"><a href="using-pipes.html"><i class="fa fa-check"></i><b>10</b> Using pipes</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-pipes.html"><a href="using-pipes.html#what-are-pipes"><i class="fa fa-check"></i><b>10.1</b> What are pipes?</a></li>
<li class="chapter" data-level="10.2" data-path="using-pipes.html"><a href="using-pipes.html#how-do-pipes-work"><i class="fa fa-check"></i><b>10.2</b> How do pipes work?</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="using-pipes.html"><a href="using-pipes.html#keyboard-shortcut"><i class="fa fa-check"></i><b>10.2.1</b> Keyboard shortcut</a></li>
<li class="chapter" data-level="10.2.2" data-path="using-pipes.html"><a href="using-pipes.html#pipe-style"><i class="fa fa-check"></i><b>10.2.2</b> Pipe style</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="using-pipes.html"><a href="using-pipes.html#final-thought-on-pipes"><i class="fa fa-check"></i><b>10.3</b> Final thought on pipes</a></li>
</ul></li>
<li class="part"><span><b>III Data Transfer</b></span></li>
<li class="chapter" data-level="11" data-path="introduction-to-data-transfer.html"><a href="introduction-to-data-transfer.html"><i class="fa fa-check"></i><b>11</b> Introduction to data transfer</a></li>
<li class="chapter" data-level="12" data-path="file-paths.html"><a href="file-paths.html"><i class="fa fa-check"></i><b>12</b> File paths</a>
<ul>
<li class="chapter" data-level="12.1" data-path="file-paths.html"><a href="file-paths.html#finding-file-paths"><i class="fa fa-check"></i><b>12.1</b> Finding file paths</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html"><i class="fa fa-check"></i><b>13</b> Importing plain text files</a>
<ul>
<li class="chapter" data-level="13.1" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#packages-for-importing-data"><i class="fa fa-check"></i><b>13.1</b> Packages for importing data</a></li>
<li class="chapter" data-level="13.2" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-space-delimited-files"><i class="fa fa-check"></i><b>13.2</b> Importing space delimited files</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#specifying-missing-data-values"><i class="fa fa-check"></i><b>13.2.1</b> Specifying missing data values</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-tab-delimited-files"><i class="fa fa-check"></i><b>13.3</b> Importing tab delimited files</a></li>
<li class="chapter" data-level="13.4" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-fixed-width-format-files"><i class="fa fa-check"></i><b>13.4</b> Importing fixed width format files</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#vector-of-column-widths"><i class="fa fa-check"></i><b>13.4.1</b> Vector of column widths</a></li>
<li class="chapter" data-level="13.4.2" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#paired-vector-of-start-and-end-positions"><i class="fa fa-check"></i><b>13.4.2</b> Paired vector of start and end positions</a></li>
<li class="chapter" data-level="13.4.3" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#using-named-arguments"><i class="fa fa-check"></i><b>13.4.3</b> Using named arguments</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#importing-comma-separated-values-files"><i class="fa fa-check"></i><b>13.5</b> Importing comma separated values files</a></li>
<li class="chapter" data-level="13.6" data-path="importing-plain-text-files.html"><a href="importing-plain-text-files.html#additional-arguments"><i class="fa fa-check"></i><b>13.6</b> Additional arguments</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="importing-binary-files.html"><a href="importing-binary-files.html"><i class="fa fa-check"></i><b>14</b> Importing binary files</a>
<ul>
<li class="chapter" data-level="14.1" data-path="importing-binary-files.html"><a href="importing-binary-files.html#packages-for-importing-data-1"><i class="fa fa-check"></i><b>14.1</b> Packages for importing data</a></li>
<li class="chapter" data-level="14.2" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-microsoft-excel-spreadsheets"><i class="fa fa-check"></i><b>14.2</b> Importing Microsoft Excel spreadsheets</a></li>
<li class="chapter" data-level="14.3" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-data-from-other-statistical-analysis-software"><i class="fa fa-check"></i><b>14.3</b> Importing data from other statistical analysis software</a></li>
<li class="chapter" data-level="14.4" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-sas-data-sets"><i class="fa fa-check"></i><b>14.4</b> Importing SAS data sets</a></li>
<li class="chapter" data-level="14.5" data-path="importing-binary-files.html"><a href="importing-binary-files.html#importing-stata-data-sets"><i class="fa fa-check"></i><b>14.5</b> Importing Stata data sets</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="rstudios-data-import-tool.html"><a href="rstudios-data-import-tool.html"><i class="fa fa-check"></i><b>15</b> RStudio’s data import tool</a></li>
<li class="chapter" data-level="16" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>16</b> Exporting data</a>
<ul>
<li class="chapter" data-level="16.1" data-path="exporting-data.html"><a href="exporting-data.html#plain-text-files"><i class="fa fa-check"></i><b>16.1</b> Plain text files</a></li>
<li class="chapter" data-level="16.2" data-path="exporting-data.html"><a href="exporting-data.html#r-binary-files"><i class="fa fa-check"></i><b>16.2</b> R binary files</a></li>
</ul></li>
<li class="part"><span><b>IV Descriptive Analysis</b></span></li>
<li class="chapter" data-level="17" data-path="introduction-to-descriptive-analysis.html"><a href="introduction-to-descriptive-analysis.html"><i class="fa fa-check"></i><b>17</b> Introduction to descriptive analysis</a>
<ul>
<li class="chapter" data-level="17.1" data-path="introduction-to-descriptive-analysis.html"><a href="introduction-to-descriptive-analysis.html#what-is-descriptive-analysis-and-why-would-we-do-it"><i class="fa fa-check"></i><b>17.1</b> What is descriptive analysis and why would we do it?</a></li>
<li class="chapter" data-level="17.2" data-path="introduction-to-descriptive-analysis.html"><a href="introduction-to-descriptive-analysis.html#what-kind-of-descriptive-analysis-should-we-perform"><i class="fa fa-check"></i><b>17.2</b> What kind of descriptive analysis should we perform?</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html"><i class="fa fa-check"></i><b>18</b> Numerical descriptions of categorical variables</a>
<ul>
<li class="chapter" data-level="18.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#factor-vectors"><i class="fa fa-check"></i><b>18.1</b> Factor vectors</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#coerce-a-numeric-variable"><i class="fa fa-check"></i><b>18.1.1</b> Coerce a numeric variable</a></li>
<li class="chapter" data-level="18.1.2" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#coerce-a-character-variable"><i class="fa fa-check"></i><b>18.1.2</b> Coerce a character variable</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#height-and-weight-data"><i class="fa fa-check"></i><b>18.2</b> Height and Weight Data</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#view-the-data"><i class="fa fa-check"></i><b>18.2.1</b> View the data</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#calculating-frequencies"><i class="fa fa-check"></i><b>18.3</b> Calculating frequencies</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#the-base-r-table-function"><i class="fa fa-check"></i><b>18.3.1</b> The base R table function</a></li>
<li class="chapter" data-level="18.3.2" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#the-gmodels-crosstable-function"><i class="fa fa-check"></i><b>18.3.2</b> The gmodels CrossTable function</a></li>
<li class="chapter" data-level="18.3.3" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#the-tidyverse-way"><i class="fa fa-check"></i><b>18.3.3</b> The tidyverse way</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#calculating-percentages"><i class="fa fa-check"></i><b>18.4</b> Calculating percentages</a></li>
<li class="chapter" data-level="18.5" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#cat-missing-data"><i class="fa fa-check"></i><b>18.5</b> Missing data</a></li>
<li class="chapter" data-level="18.6" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#formatting-results"><i class="fa fa-check"></i><b>18.6</b> Formatting results</a></li>
<li class="chapter" data-level="18.7" data-path="numerical-descriptions-of-categorical-variables.html"><a href="numerical-descriptions-of-categorical-variables.html#using-freqtables"><i class="fa fa-check"></i><b>18.7</b> Using freqtables</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html"><i class="fa fa-check"></i><b>19</b> Measures of central tendency</a>
<ul>
<li class="chapter" data-level="19.1" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#calculate-the-mean"><i class="fa fa-check"></i><b>19.1</b> Calculate the mean</a></li>
<li class="chapter" data-level="19.2" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#calculate-the-median"><i class="fa fa-check"></i><b>19.2</b> Calculate the median</a></li>
<li class="chapter" data-level="19.3" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#calculate-the-mode"><i class="fa fa-check"></i><b>19.3</b> Calculate the mode</a></li>
<li class="chapter" data-level="19.4" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#compare-mean-median-and-mode"><i class="fa fa-check"></i><b>19.4</b> Compare mean, median, and mode</a></li>
<li class="chapter" data-level="19.5" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#data-checking"><i class="fa fa-check"></i><b>19.5</b> Data checking</a></li>
<li class="chapter" data-level="19.6" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#properties-of-mean-median-and-mode"><i class="fa fa-check"></i><b>19.6</b> Properties of mean, median, and mode</a></li>
<li class="chapter" data-level="19.7" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#na-rm"><i class="fa fa-check"></i><b>19.7</b> Missing data</a></li>
<li class="chapter" data-level="19.8" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html#using-meantables"><i class="fa fa-check"></i><b>19.8</b> Using meantables</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html"><i class="fa fa-check"></i><b>20</b> Measures of dispersion</a>
<ul>
<li class="chapter" data-level="20.1" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html#comparing-distributions"><i class="fa fa-check"></i><b>20.1</b> Comparing distributions</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><i class="fa fa-check"></i><b>21</b> Describing the relationship between a continuous outcome and a continuous predictor</a>
<ul>
<li class="chapter" data-level="21.1" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html#pearson-correlation-coefficient"><i class="fa fa-check"></i><b>21.1</b> Pearson Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html#calculating-r"><i class="fa fa-check"></i><b>21.1.1</b> Calculating r</a></li>
<li class="chapter" data-level="21.1.2" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-continuous-predictor.html#correlation-intuition"><i class="fa fa-check"></i><b>21.1.2</b> Correlation intuition</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><i class="fa fa-check"></i><b>22</b> Describing the relationship between a continuous outcome and a categorical predictor</a>
<ul>
<li class="chapter" data-level="22.1" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html#single-predictor-and-single-outcome"><i class="fa fa-check"></i><b>22.1</b> Single predictor and single outcome</a></li>
<li class="chapter" data-level="22.2" data-path="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-continuous-outcome-and-a-categorical-predictor.html#multiple-predictors"><i class="fa fa-check"></i><b>22.2</b> Multiple predictors</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html"><i class="fa fa-check"></i><b>23</b> Describing the relationship between a categorical outcome and a categorical predictor</a>
<ul>
<li class="chapter" data-level="23.1" data-path="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html"><a href="describing-the-relationship-between-a-categorical-outcome-and-a-categorical-predictor.html#comparing-two-variables"><i class="fa fa-check"></i><b>23.1</b> Comparing two variables</a></li>
</ul></li>
<li class="part"><span><b>V Data Management</b></span></li>
<li class="chapter" data-level="24" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html"><i class="fa fa-check"></i><b>24</b> Introduction to data management</a>
<ul>
<li class="chapter" data-level="24.1" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#multiple-paradigms-for-data-management-in-r"><i class="fa fa-check"></i><b>24.1</b> Multiple paradigms for data management in R</a></li>
<li class="chapter" data-level="24.2" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-dplyr-package"><i class="fa fa-check"></i><b>24.2</b> The dplyr package</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-dplyr-verbs"><i class="fa fa-check"></i><b>24.2.1</b> The dplyr verbs</a></li>
<li class="chapter" data-level="24.2.2" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-.data-argument"><i class="fa fa-check"></i><b>24.2.2</b> The .data argument</a></li>
<li class="chapter" data-level="24.2.3" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#the-argument"><i class="fa fa-check"></i><b>24.2.3</b> The … argument</a></li>
<li class="chapter" data-level="24.2.4" data-path="introduction-to-data-management.html"><a href="introduction-to-data-management.html#non-standard-evaluation"><i class="fa fa-check"></i><b>24.2.4</b> Non-standard evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html"><i class="fa fa-check"></i><b>25</b> Creating and modifying columns</a>
<ul>
<li class="chapter" data-level="25.1" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#creating-data-frames"><i class="fa fa-check"></i><b>25.1</b> Creating data frames</a></li>
<li class="chapter" data-level="25.2" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#dollar-sign-notation-1"><i class="fa fa-check"></i><b>25.2</b> Dollar sign notation</a></li>
<li class="chapter" data-level="25.3" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#bracket-notation-1"><i class="fa fa-check"></i><b>25.3</b> Bracket notation</a></li>
<li class="chapter" data-level="25.4" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#modify-individual-values"><i class="fa fa-check"></i><b>25.4</b> Modify individual values</a></li>
<li class="chapter" data-level="25.5" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#the-mutate-function"><i class="fa fa-check"></i><b>25.5</b> The mutate() function</a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#adding-or-modifying-a-single-column"><i class="fa fa-check"></i><b>25.5.1</b> Adding or modifying a single column</a></li>
<li class="chapter" data-level="25.5.2" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#recycling-rules"><i class="fa fa-check"></i><b>25.5.2</b> Recycling rules</a></li>
<li class="chapter" data-level="25.5.3" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#using-existing-variables-in-name-value-pairs"><i class="fa fa-check"></i><b>25.5.3</b> Using existing variables in name-value pairs</a></li>
<li class="chapter" data-level="25.5.4" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#adding-or-modifying-multiple-columns"><i class="fa fa-check"></i><b>25.5.4</b> Adding or modifying multiple columns</a></li>
<li class="chapter" data-level="25.5.5" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#rowwise-mutations"><i class="fa fa-check"></i><b>25.5.5</b> Rowwise mutations</a></li>
<li class="chapter" data-level="25.5.6" data-path="creating-and-modifying-columns.html"><a href="creating-and-modifying-columns.html#group_by-mutations"><i class="fa fa-check"></i><b>25.5.6</b> Group_by mutations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html"><i class="fa fa-check"></i><b>26</b> Subsetting data frames</a>
<ul>
<li class="chapter" data-level="26.1" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-select-function"><i class="fa fa-check"></i><b>26.1</b> The select() function</a></li>
<li class="chapter" data-level="26.2" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-rename-function"><i class="fa fa-check"></i><b>26.2</b> The rename() function</a></li>
<li class="chapter" data-level="26.3" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-filter-function"><i class="fa fa-check"></i><b>26.3</b> The filter() function</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#subgroup-analysis"><i class="fa fa-check"></i><b>26.3.1</b> Subgroup analysis</a></li>
<li class="chapter" data-level="26.3.2" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#complete-case-analysis"><i class="fa fa-check"></i><b>26.3.2</b> Complete case analysis</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#deduplication"><i class="fa fa-check"></i><b>26.4</b> Deduplication</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#the-distinct-function"><i class="fa fa-check"></i><b>26.4.1</b> The distinct() function</a></li>
<li class="chapter" data-level="26.4.2" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#complete-duplicate-row-add-tag"><i class="fa fa-check"></i><b>26.4.2</b> Complete duplicate row add tag</a></li>
<li class="chapter" data-level="26.4.3" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#partial-duplicate-rows"><i class="fa fa-check"></i><b>26.4.3</b> Partial duplicate rows</a></li>
<li class="chapter" data-level="26.4.4" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#partial-duplicate-rows---add-tag"><i class="fa fa-check"></i><b>26.4.4</b> Partial duplicate rows - add tag</a></li>
<li class="chapter" data-level="26.4.5" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#count-the-number-of-duplicates"><i class="fa fa-check"></i><b>26.4.5</b> Count the number of duplicates</a></li>
<li class="chapter" data-level="26.4.6" data-path="subsetting-data-frames.html"><a href="subsetting-data-frames.html#what-to-do-about-duplicates"><i class="fa fa-check"></i><b>26.4.6</b> What to do about duplicates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="working-with-dates.html"><a href="working-with-dates.html"><i class="fa fa-check"></i><b>27</b> Working with dates</a>
<ul>
<li class="chapter" data-level="27.1" data-path="working-with-dates.html"><a href="working-with-dates.html#date-vector-types"><i class="fa fa-check"></i><b>27.1</b> Date vector types</a></li>
<li class="chapter" data-level="27.2" data-path="working-with-dates.html"><a href="working-with-dates.html#dates-under-the-hood"><i class="fa fa-check"></i><b>27.2</b> Dates under the hood</a></li>
<li class="chapter" data-level="27.3" data-path="working-with-dates.html"><a href="working-with-dates.html#coercing-date-times-to-dates"><i class="fa fa-check"></i><b>27.3</b> Coercing date-times to dates</a></li>
<li class="chapter" data-level="27.4" data-path="working-with-dates.html"><a href="working-with-dates.html#coercing-character-strings-to-dates"><i class="fa fa-check"></i><b>27.4</b> Coercing character strings to dates</a></li>
<li class="chapter" data-level="27.5" data-path="working-with-dates.html"><a href="working-with-dates.html#change-the-appearance-of-dates-with-format"><i class="fa fa-check"></i><b>27.5</b> Change the appearance of dates with format()</a></li>
<li class="chapter" data-level="27.6" data-path="working-with-dates.html"><a href="working-with-dates.html#some-useful-built-in-dates"><i class="fa fa-check"></i><b>27.6</b> Some useful built-in dates</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="working-with-dates.html"><a href="working-with-dates.html#todays-date"><i class="fa fa-check"></i><b>27.6.1</b> Today’s date</a></li>
<li class="chapter" data-level="27.6.2" data-path="working-with-dates.html"><a href="working-with-dates.html#todays-date-time"><i class="fa fa-check"></i><b>27.6.2</b> Today’s date-time</a></li>
<li class="chapter" data-level="27.6.3" data-path="working-with-dates.html"><a href="working-with-dates.html#character-vector-of-full-month-names"><i class="fa fa-check"></i><b>27.6.3</b> Character vector of full month names</a></li>
<li class="chapter" data-level="27.6.4" data-path="working-with-dates.html"><a href="working-with-dates.html#character-vector-of-abbreviated-month-names"><i class="fa fa-check"></i><b>27.6.4</b> Character vector of abbreviated month names</a></li>
<li class="chapter" data-level="27.6.5" data-path="working-with-dates.html"><a href="working-with-dates.html#creating-a-vector-containing-a-sequence-of-dates"><i class="fa fa-check"></i><b>27.6.5</b> Creating a vector containing a sequence of dates</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="working-with-dates.html"><a href="working-with-dates.html#calculating-date-intervals"><i class="fa fa-check"></i><b>27.7</b> Calculating date intervals</a>
<ul>
<li class="chapter" data-level="27.7.1" data-path="working-with-dates.html"><a href="working-with-dates.html#calculate-age-as-the-difference-in-time-between-dob-and-today"><i class="fa fa-check"></i><b>27.7.1</b> Calculate age as the difference in time between dob and today</a></li>
<li class="chapter" data-level="27.7.2" data-path="working-with-dates.html"><a href="working-with-dates.html#rounding-time-intervals"><i class="fa fa-check"></i><b>27.7.2</b> Rounding time intervals</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="working-with-dates.html"><a href="working-with-dates.html#extracting-out-date-parts"><i class="fa fa-check"></i><b>27.8</b> Extracting out date parts</a></li>
<li class="chapter" data-level="27.9" data-path="working-with-dates.html"><a href="working-with-dates.html#sorting-dates"><i class="fa fa-check"></i><b>27.9</b> Sorting dates</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html"><i class="fa fa-check"></i><b>28</b> Working with character strings</a>
<ul>
<li class="chapter" data-level="28.1" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#coerce-to-lowercase"><i class="fa fa-check"></i><b>28.1</b> Coerce to lowercase</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#lowercase"><i class="fa fa-check"></i><b>28.1.1</b> Lowercase</a></li>
<li class="chapter" data-level="28.1.2" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#upper-case"><i class="fa fa-check"></i><b>28.1.2</b> Upper case</a></li>
<li class="chapter" data-level="28.1.3" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#title-case"><i class="fa fa-check"></i><b>28.1.3</b> Title case</a></li>
<li class="chapter" data-level="28.1.4" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#sentence-case"><i class="fa fa-check"></i><b>28.1.4</b> Sentence case</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#trim-white-space"><i class="fa fa-check"></i><b>28.2</b> Trim white space</a></li>
<li class="chapter" data-level="28.3" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#regular-expressions"><i class="fa fa-check"></i><b>28.3</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#remove-the-comma"><i class="fa fa-check"></i><b>28.3.1</b> Remove the comma</a></li>
<li class="chapter" data-level="28.3.2" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#remove-middle-initial"><i class="fa fa-check"></i><b>28.3.2</b> Remove middle initial</a></li>
<li class="chapter" data-level="28.3.3" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#remove-double-spaces"><i class="fa fa-check"></i><b>28.3.3</b> Remove double spaces</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#separate-values-into-component-parts"><i class="fa fa-check"></i><b>28.4</b> Separate values into component parts</a></li>
<li class="chapter" data-level="28.5" data-path="working-with-character-strings.html"><a href="working-with-character-strings.html#dummy-variables"><i class="fa fa-check"></i><b>28.5</b> Dummy variables</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="conditional-operations.html"><a href="conditional-operations.html"><i class="fa fa-check"></i><b>29</b> Conditional operations</a>
<ul>
<li class="chapter" data-level="29.1" data-path="conditional-operations.html"><a href="conditional-operations.html#operands-and-operators"><i class="fa fa-check"></i><b>29.1</b> Operands and operators</a></li>
<li class="chapter" data-level="29.2" data-path="conditional-operations.html"><a href="conditional-operations.html#testing-multiple-conditions-simultaneously"><i class="fa fa-check"></i><b>29.2</b> Testing multiple conditions simultaneously</a></li>
<li class="chapter" data-level="29.3" data-path="conditional-operations.html"><a href="conditional-operations.html#testing-a-sequence-of-conditions"><i class="fa fa-check"></i><b>29.3</b> Testing a sequence of conditions</a></li>
<li class="chapter" data-level="29.4" data-path="conditional-operations.html"><a href="conditional-operations.html#recoding-variables"><i class="fa fa-check"></i><b>29.4</b> Recoding variables</a></li>
<li class="chapter" data-level="29.5" data-path="conditional-operations.html"><a href="conditional-operations.html#case_when-is-lazy"><i class="fa fa-check"></i><b>29.5</b> case_when() is lazy</a></li>
<li class="chapter" data-level="29.6" data-path="conditional-operations.html"><a href="conditional-operations.html#recode-missing"><i class="fa fa-check"></i><b>29.6</b> Recode missing</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html"><i class="fa fa-check"></i><b>30</b> Working with multiple data frames</a>
<ul>
<li class="chapter" data-level="30.1" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-vertically-adding-rows"><i class="fa fa-check"></i><b>30.1</b> Combining data frames vertically: Adding rows</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-more-than-2-data-frames"><i class="fa fa-check"></i><b>30.1.1</b> Combining more than 2 data frames</a></li>
<li class="chapter" data-level="30.1.2" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#adding-rows-with-differing-columns"><i class="fa fa-check"></i><b>30.1.2</b> Adding rows with differing columns</a></li>
<li class="chapter" data-level="30.1.3" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#differing-column-positions"><i class="fa fa-check"></i><b>30.1.3</b> Differing column positions</a></li>
<li class="chapter" data-level="30.1.4" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#differing-column-names"><i class="fa fa-check"></i><b>30.1.4</b> Differing column names</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-horizontally-adding-columns"><i class="fa fa-check"></i><b>30.2</b> Combining data frames horizontally: Adding columns</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-horizontally-by-position"><i class="fa fa-check"></i><b>30.2.1</b> Combining data frames horizontally by position</a></li>
<li class="chapter" data-level="30.2.2" data-path="working-with-multiple-data-frames.html"><a href="working-with-multiple-data-frames.html#combining-data-frames-horizontally-by-key-values"><i class="fa fa-check"></i><b>30.2.2</b> Combining data frames horizontally by key values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html"><i class="fa fa-check"></i><b>31</b> Restructuring data frames</a>
<ul>
<li class="chapter" data-level="31.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-tidyr-package"><i class="fa fa-check"></i><b>31.1</b> The tidyr package</a></li>
<li class="chapter" data-level="31.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-longer"><i class="fa fa-check"></i><b>31.2</b> Pivoting longer</a>
<ul>
<li class="chapter" data-level="31.2.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_to-argument"><i class="fa fa-check"></i><b>31.2.1</b> The names_to argument</a></li>
<li class="chapter" data-level="31.2.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_prefix-argument"><i class="fa fa-check"></i><b>31.2.2</b> The names_prefix argument</a></li>
<li class="chapter" data-level="31.2.3" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-values_to-argument"><i class="fa fa-check"></i><b>31.2.3</b> The values_to argument</a></li>
<li class="chapter" data-level="31.2.4" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_transform-argument"><i class="fa fa-check"></i><b>31.2.4</b> The names_transform argument</a></li>
<li class="chapter" data-level="31.2.5" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-multiple-sets-of-columns"><i class="fa fa-check"></i><b>31.2.5</b> Pivoting multiple sets of columns</a></li>
<li class="chapter" data-level="31.2.6" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-names_sep-argument"><i class="fa fa-check"></i><b>31.2.6</b> The names_sep argument</a></li>
<li class="chapter" data-level="31.2.7" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-.value-special-value"><i class="fa fa-check"></i><b>31.2.7</b> The .value special value</a></li>
<li class="chapter" data-level="31.2.8" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#why-person-period"><i class="fa fa-check"></i><b>31.2.8</b> Why person-period?</a></li>
</ul></li>
<li class="chapter" data-level="31.3" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-wider"><i class="fa fa-check"></i><b>31.3</b> Pivoting wider</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#why-person-level"><i class="fa fa-check"></i><b>31.3.1</b> Why person-level?</a></li>
</ul></li>
<li class="chapter" data-level="31.4" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-summary-statistics"><i class="fa fa-check"></i><b>31.4</b> Pivoting summary statistics</a>
<ul>
<li class="chapter" data-level="31.4.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-summary-statistics-wide-to-long"><i class="fa fa-check"></i><b>31.4.1</b> Pivoting summary statistics wide to long</a></li>
<li class="chapter" data-level="31.4.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#pivoting-summary-statistics-long-to-wide"><i class="fa fa-check"></i><b>31.4.2</b> Pivoting summary statistics long to wide</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#tidy-data"><i class="fa fa-check"></i><b>31.5</b> Tidy data</a>
<ul>
<li class="chapter" data-level="31.5.1" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#each-variable-must-have-its-own-column"><i class="fa fa-check"></i><b>31.5.1</b> Each variable must have its own column</a></li>
<li class="chapter" data-level="31.5.2" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#each-observation-must-have-its-own-row"><i class="fa fa-check"></i><b>31.5.2</b> Each observation must have its own row</a></li>
<li class="chapter" data-level="31.5.3" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#each-value-must-have-its-own-cell"><i class="fa fa-check"></i><b>31.5.3</b> Each value must have its own cell</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="restructuring-data-frames.html"><a href="restructuring-data-frames.html#the-complete-function"><i class="fa fa-check"></i><b>31.6</b> The complete() function</a></li>
</ul></li>
<li class="part"><span><b>VI Repeated Operations</b></span></li>
<li class="chapter" data-level="32" data-path="introduction-to-repeated-operations.html"><a href="introduction-to-repeated-operations.html"><i class="fa fa-check"></i><b>32</b> Introduction to repeated operations</a>
<ul>
<li class="chapter" data-level="32.1" data-path="introduction-to-repeated-operations.html"><a href="introduction-to-repeated-operations.html#multiple-methods-for-repeated-operations-in-r"><i class="fa fa-check"></i><b>32.1</b> Multiple methods for repeated operations in R</a></li>
<li class="chapter" data-level="32.2" data-path="introduction-to-repeated-operations.html"><a href="introduction-to-repeated-operations.html#tidy-evaluation"><i class="fa fa-check"></i><b>32.2</b> Tidy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="writing-functions.html"><a href="writing-functions.html"><i class="fa fa-check"></i><b>33</b> Writing functions</a>
<ul>
<li class="chapter" data-level="33.1" data-path="writing-functions.html"><a href="writing-functions.html#when-to-write-functions"><i class="fa fa-check"></i><b>33.1</b> When to write functions</a></li>
<li class="chapter" data-level="33.2" data-path="writing-functions.html"><a href="writing-functions.html#how-to-write-functions"><i class="fa fa-check"></i><b>33.2</b> How to write functions</a>
<ul>
<li class="chapter" data-level="33.2.1" data-path="writing-functions.html"><a href="writing-functions.html#the-function-function"><i class="fa fa-check"></i><b>33.2.1</b> The function() function</a></li>
<li class="chapter" data-level="33.2.2" data-path="writing-functions.html"><a href="writing-functions.html#the-function-writing-process"><i class="fa fa-check"></i><b>33.2.2</b> The function writing process</a></li>
</ul></li>
<li class="chapter" data-level="33.3" data-path="writing-functions.html"><a href="writing-functions.html#giving-your-function-arguments-default-values"><i class="fa fa-check"></i><b>33.3</b> Giving your function arguments default values</a></li>
<li class="chapter" data-level="33.4" data-path="writing-functions.html"><a href="writing-functions.html#the-values-your-functions-return"><i class="fa fa-check"></i><b>33.4</b> The values your functions return</a></li>
<li class="chapter" data-level="33.5" data-path="writing-functions.html"><a href="writing-functions.html#lexical-scoping-and-functions"><i class="fa fa-check"></i><b>33.5</b> Lexical scoping and functions</a></li>
<li class="chapter" data-level="33.6" data-path="writing-functions.html"><a href="writing-functions.html#tidy-evaluation-1"><i class="fa fa-check"></i><b>33.6</b> Tidy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html"><i class="fa fa-check"></i><b>34</b> Column-wise operations in dplyr</a>
<ul>
<li class="chapter" data-level="34.1" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#the-across-function"><i class="fa fa-check"></i><b>34.1</b> The across() function</a></li>
<li class="chapter" data-level="34.2" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#across-with-filter"><i class="fa fa-check"></i><b>34.2</b> Across with filter</a></li>
<li class="chapter" data-level="34.3" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#across-with-mutate"><i class="fa fa-check"></i><b>34.3</b> Across with mutate</a></li>
<li class="chapter" data-level="34.4" data-path="column-wise-operations-in-dplyr.html"><a href="column-wise-operations-in-dplyr.html#across-with-summarise"><i class="fa fa-check"></i><b>34.4</b> Across with summarise</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="writing-for-loops.html"><a href="writing-for-loops.html"><i class="fa fa-check"></i><b>35</b> Writing for loops</a>
<ul>
<li class="chapter" data-level="35.1" data-path="writing-for-loops.html"><a href="writing-for-loops.html#how-to-write-for-loops"><i class="fa fa-check"></i><b>35.1</b> How to write for loops</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="writing-for-loops.html"><a href="writing-for-loops.html#the-for-loop-body"><i class="fa fa-check"></i><b>35.1.1</b> The for loop body</a></li>
<li class="chapter" data-level="35.1.2" data-path="writing-for-loops.html"><a href="writing-for-loops.html#the-for-function"><i class="fa fa-check"></i><b>35.1.2</b> The for() function</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="writing-for-loops.html"><a href="writing-for-loops.html#using-for-loops-for-data-transfer"><i class="fa fa-check"></i><b>35.2</b> Using for loops for data transfer</a></li>
<li class="chapter" data-level="35.3" data-path="writing-for-loops.html"><a href="writing-for-loops.html#using-for-loops-for-data-management"><i class="fa fa-check"></i><b>35.3</b> Using for loops for data management</a></li>
<li class="chapter" data-level="35.4" data-path="writing-for-loops.html"><a href="writing-for-loops.html#using-for-loops-for-analysis"><i class="fa fa-check"></i><b>35.4</b> Using for loops for analysis</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html"><i class="fa fa-check"></i><b>36</b> Using the purrr package</a>
<ul>
<li class="chapter" data-level="36.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#comparing-for-loops-and-the-map-functions"><i class="fa fa-check"></i><b>36.1</b> Comparing for loops and the map functions</a></li>
<li class="chapter" data-level="36.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#using-purrr-for-data-transfer"><i class="fa fa-check"></i><b>36.2</b> Using purrr for data transfer</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-1-importing-multiple-sheets-from-an-excel-workbook"><i class="fa fa-check"></i><b>36.2.1</b> Example 1: Importing multiple sheets from an Excel workbook</a></li>
<li class="chapter" data-level="36.2.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#why-walk-instead-of-map"><i class="fa fa-check"></i><b>36.2.2</b> Why walk instead of map?</a></li>
<li class="chapter" data-level="36.2.3" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#why-we-didnt-assign-the-return-value-of-walk-to-an-object"><i class="fa fa-check"></i><b>36.2.3</b> why we didn’t assign the return value of <code>walk()</code> to an object?</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#using-purrr-for-data-management"><i class="fa fa-check"></i><b>36.3</b> Using purrr for data management</a>
<ul>
<li class="chapter" data-level="36.3.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-1-adding-na-at-multiple-positions"><i class="fa fa-check"></i><b>36.3.1</b> Example 1: Adding NA at multiple positions</a></li>
<li class="chapter" data-level="36.3.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-2.-detecting-matching-values-by-position"><i class="fa fa-check"></i><b>36.3.2</b> Example 2. Detecting matching values by position</a></li>
</ul></li>
<li class="chapter" data-level="36.4" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#using-purrr-for-analysis"><i class="fa fa-check"></i><b>36.4</b> Using purrr for analysis</a>
<ul>
<li class="chapter" data-level="36.4.1" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-1-continuous-statistics"><i class="fa fa-check"></i><b>36.4.1</b> Example 1: Continuous statistics</a></li>
<li class="chapter" data-level="36.4.2" data-path="using-the-purrr-package.html"><a href="using-the-purrr-package.html#example-2-categorical-statistics"><i class="fa fa-check"></i><b>36.4.2</b> Example 2: Categorical statistics</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Presenting Results</b></span></li>
<li class="chapter" data-level="37" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html"><i class="fa fa-check"></i><b>37</b> Creating tables with R and Microsoft Word</a>
<ul>
<li class="chapter" data-level="37.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#table-1"><i class="fa fa-check"></i><b>37.1</b> Table 1</a></li>
<li class="chapter" data-level="37.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#opioid-drug-use"><i class="fa fa-check"></i><b>37.2</b> Opioid drug use</a></li>
<li class="chapter" data-level="37.3" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#table-columns"><i class="fa fa-check"></i><b>37.3</b> Table columns</a></li>
<li class="chapter" data-level="37.4" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#table-rows"><i class="fa fa-check"></i><b>37.4</b> Table rows</a></li>
<li class="chapter" data-level="37.5" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#make-the-table-skeleton"><i class="fa fa-check"></i><b>37.5</b> Make the table skeleton</a></li>
<li class="chapter" data-level="37.6" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-column-headers"><i class="fa fa-check"></i><b>37.6</b> Fill in column headers</a>
<ul>
<li class="chapter" data-level="37.6.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#group-sample-sizes"><i class="fa fa-check"></i><b>37.6.1</b> Group sample sizes</a></li>
<li class="chapter" data-level="37.6.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-column-headers"><i class="fa fa-check"></i><b>37.6.2</b> Formatting column headers</a></li>
</ul></li>
<li class="chapter" data-level="37.7" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-row-headers"><i class="fa fa-check"></i><b>37.7</b> Fill in row headers</a>
<ul>
<li class="chapter" data-level="37.7.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#label-statistics"><i class="fa fa-check"></i><b>37.7.1</b> Label statistics</a></li>
<li class="chapter" data-level="37.7.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-row-headers"><i class="fa fa-check"></i><b>37.7.2</b> Formatting row headers</a></li>
</ul></li>
<li class="chapter" data-level="37.8" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-data-values"><i class="fa fa-check"></i><b>37.8</b> Fill in data values</a>
<ul>
<li class="chapter" data-level="37.8.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#manually-type-values"><i class="fa fa-check"></i><b>37.8.1</b> Manually type values</a></li>
<li class="chapter" data-level="37.8.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#copy-and-paste-values"><i class="fa fa-check"></i><b>37.8.2</b> Copy and paste values</a></li>
<li class="chapter" data-level="37.8.3" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#knit-a-word-document"><i class="fa fa-check"></i><b>37.8.3</b> Knit a Word document</a></li>
<li class="chapter" data-level="37.8.4" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#flextable-and-officer"><i class="fa fa-check"></i><b>37.8.4</b> flextable and officer</a></li>
<li class="chapter" data-level="37.8.5" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#significant-digits"><i class="fa fa-check"></i><b>37.8.5</b> Significant digits</a></li>
<li class="chapter" data-level="37.8.6" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-data-values"><i class="fa fa-check"></i><b>37.8.6</b> Formatting data values</a></li>
</ul></li>
<li class="chapter" data-level="37.9" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-title"><i class="fa fa-check"></i><b>37.9</b> Fill in title</a></li>
<li class="chapter" data-level="37.10" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#fill-in-footnotes"><i class="fa fa-check"></i><b>37.10</b> Fill in footnotes</a>
<ul>
<li class="chapter" data-level="37.10.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#formatting-footnotes"><i class="fa fa-check"></i><b>37.10.1</b> Formatting footnotes</a></li>
</ul></li>
<li class="chapter" data-level="37.11" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#final-formatting"><i class="fa fa-check"></i><b>37.11</b> Final formatting</a>
<ul>
<li class="chapter" data-level="37.11.1" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#adjust-column-widths"><i class="fa fa-check"></i><b>37.11.1</b> Adjust column widths</a></li>
<li class="chapter" data-level="37.11.2" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#merge-cells"><i class="fa fa-check"></i><b>37.11.2</b> Merge cells</a></li>
<li class="chapter" data-level="37.11.3" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#remove-cell-borders"><i class="fa fa-check"></i><b>37.11.3</b> Remove cell borders</a></li>
</ul></li>
<li class="chapter" data-level="37.12" data-path="creating-tables-with-r-and-microsoft-word.html"><a href="creating-tables-with-r-and-microsoft-word.html#summary-1"><i class="fa fa-check"></i><b>37.12</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>VIII Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendix-a-glossary.html"><a href="appendix-a-glossary.html"><i class="fa fa-check"></i>Appendix A: Glossary</a></li>
<li class="chapter" data-level="" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html"><i class="fa fa-check"></i>Appendix: Alternative table formats</a>
<ul>
<li class="chapter" data-level="37.13" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#smaller-data-frame"><i class="fa fa-check"></i><b>37.13</b> Smaller data frame</a>
<ul>
<li class="chapter" data-level="37.13.1" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#default-method-for-printing-the-data-frame-to-the-screen"><i class="fa fa-check"></i><b>37.13.1</b> Default method for printing the data frame to the screen</a></li>
<li class="chapter" data-level="37.13.2" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-kable-function"><i class="fa fa-check"></i><b>37.13.2</b> Using the kable function</a></li>
<li class="chapter" data-level="37.13.3" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-datatable-function"><i class="fa fa-check"></i><b>37.13.3</b> Using the datatable function</a></li>
</ul></li>
<li class="chapter" data-level="37.14" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#larger-data-frame"><i class="fa fa-check"></i><b>37.14</b> Larger data frame</a>
<ul>
<li class="chapter" data-level="37.14.1" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#default-method-for-printing-the-data-frame-to-the-screen-1"><i class="fa fa-check"></i><b>37.14.1</b> Default method for printing the data frame to the screen</a></li>
<li class="chapter" data-level="37.14.2" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-kable-function-1"><i class="fa fa-check"></i><b>37.14.2</b> Using the kable function</a></li>
<li class="chapter" data-level="37.14.3" data-path="appendix-alternative-table-formats.html"><a href="appendix-alternative-table-formats.html#using-the-datatable-function-1"><i class="fa fa-check"></i><b>37.14.3</b> Using the datatable function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Epidemiology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="writing-for-loops" class="section level1" number="35">
<h1><span class="header-section-number">35</span> Writing for loops</h1>
<!--

-->
<p>In this third chapter on repeated operations, we are going to discuss writing <strong>for loops</strong>.</p>
<p><img src="img/07_part_repeated_operations/01_intro/stickers.png" width="900" /></p>
<p>In other documents you read, you may see for loops referred to as iterative processing, iterative operations, iteration, or just loops. Regardless of what you call them, for loops are not unique to R. Basically every statistical software application I’m aware of allows users to write for loops; although, the exact words and symbols used to construct them may differ slightly from one program to another.</p>
<p>Let’s take a look at an example. After seeing a working example, we will take the code apart iteratively (do you see what I did there? 😆) to figure out how it works.</p>
<p>We’ll start by simulating some data. This is the same data we simulated at the beginning of the chapter on column-wise operations in <code>dplyr</code>. It’s a data frame that contains three columns of 10 random numbers:</p>
<div class="sourceCode" id="cb1285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1285-1"><a href="writing-for-loops.html#cb1285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb1286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1286-1"><a href="writing-for-loops.html#cb1286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1286-2"><a href="writing-for-loops.html#cb1286-2" aria-hidden="true" tabindex="-1"></a>df_xyz <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1286-3"><a href="writing-for-loops.html#cb1286-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb1286-4"><a href="writing-for-loops.html#cb1286-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>),</span>
<span id="cb1286-5"><a href="writing-for-loops.html#cb1286-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb1286-6"><a href="writing-for-loops.html#cb1286-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1286-7"><a href="writing-for-loops.html#cb1286-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##          x      y      z
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 -0.560   1.22  -1.07 
##  2 -0.230   0.360 -0.218
##  3  1.56    0.401 -1.03 
##  4  0.0705  0.111 -0.729
##  5  0.129  -0.556 -0.625
##  6  1.72    1.79  -1.69 
##  7  0.461   0.498  0.838
##  8 -1.27   -1.97   0.153
##  9 -0.687   0.701 -1.14 
## 10 -0.446  -0.473  1.25</code></pre>
<p>As we previously discussed, if we wanted to find the mean of each column before learning about repeated operations, we would probably have written code like this:</p>
<div class="sourceCode" id="cb1288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1288-1"><a href="writing-for-loops.html#cb1288-1" aria-hidden="true" tabindex="-1"></a>df_xyz <span class="sc">%&gt;%</span> </span>
<span id="cb1288-2"><a href="writing-for-loops.html#cb1288-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1288-3"><a href="writing-for-loops.html#cb1288-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_mean =</span> <span class="fu">mean</span>(x),</span>
<span id="cb1288-4"><a href="writing-for-loops.html#cb1288-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_mean =</span> <span class="fu">mean</span>(y),</span>
<span id="cb1288-5"><a href="writing-for-loops.html#cb1288-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_mean =</span> <span class="fu">mean</span>(y)</span>
<span id="cb1288-6"><a href="writing-for-loops.html#cb1288-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   x_mean y_mean z_mean
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.0746  0.209  0.209</code></pre>
<p>In the previous chapter, we learned how to use the <code>across()</code> function to remove unnecessary repetition from our code like this:</p>
<div class="sourceCode" id="cb1290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1290-1"><a href="writing-for-loops.html#cb1290-1" aria-hidden="true" tabindex="-1"></a>df_xyz <span class="sc">%&gt;%</span></span>
<span id="cb1290-2"><a href="writing-for-loops.html#cb1290-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1290-3"><a href="writing-for-loops.html#cb1290-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb1290-4"><a href="writing-for-loops.html#cb1290-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols  =</span> <span class="fu">everything</span>(),</span>
<span id="cb1290-5"><a href="writing-for-loops.html#cb1290-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns   =</span> mean,</span>
<span id="cb1290-6"><a href="writing-for-loops.html#cb1290-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">&quot;{col}_mean&quot;</span></span>
<span id="cb1290-7"><a href="writing-for-loops.html#cb1290-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1290-8"><a href="writing-for-loops.html#cb1290-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   x_mean y_mean z_mean
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.0746  0.209 -0.425</code></pre>
<p>An alternative approach that would also work is to use a for loop like this:</p>
<div class="sourceCode" id="cb1292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1292-1"><a href="writing-for-loops.html#cb1292-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">ncol</span>(df_xyz))</span>
<span id="cb1292-2"><a href="writing-for-loops.html#cb1292-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1292-3"><a href="writing-for-loops.html#cb1292-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(df_xyz)) {</span>
<span id="cb1292-4"><a href="writing-for-loops.html#cb1292-4" aria-hidden="true" tabindex="-1"></a>  xyz_means[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[i]])</span>
<span id="cb1292-5"><a href="writing-for-loops.html#cb1292-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1293-1"><a href="writing-for-loops.html#cb1293-1" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887</code></pre>
<p>I think most people would agree that the for loop code is a little more complicated looking, and it’s a little bit harder to quickly glance at it and figure out what’s going on. It may even be a little bit intimidating for some of you.</p>
<p>Also, note that the result from the code that uses the <code>across()</code> function is a data frame with three columns and one row. The result from the code that uses a for loop is a character vector with three elements.</p>
<p>For the particular case above, I would personally use the <code>across()</code> function instead of a for loop. However, as we will see below, there are some challenges that can be overcome with for loops that cannot currently be overcome with the <code>across()</code> function. But, before we jump into more examples, let’s take a look at the basic structure of the for loop.</p>
<div id="how-to-write-for-loops" class="section level2" number="35.1">
<h2><span class="header-section-number">35.1</span> How to write for loops</h2>
<p>For starters, <em>using</em> for loops in practice will generally require us to write code for two separate structures: An object to contain the results of our for loop and the for loop itself.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/two_structures.png" width="900" /></p>
<p>In practice, we will generally write the code for structure 1 before writing the code for structure 2. However, I think it will be easier to understand why we need structure 1 if we first learn about the components of the for loop, and how they work together. Further, I think it will be easiest to understand the components of the for loop if we start on the inside and work our way out. Therefore, the first component of for loops that we are going to discuss is the body.</p>
<div id="the-for-loop-body" class="section level3" number="35.1.1">
<h3><span class="header-section-number">35.1.1</span> The for loop body</h3>
<p><img src="img/07_part_repeated_operations/04_for_loops/body.png" width="900" /></p>
<p>Similar to when we learned to write our own functions, the body of the for loop is where all the “stuff” happens. This is where we write the code that we want to be executed over and over. In our example, we want the mean value of the <code>x</code> column, the mean value of the <code>y</code> column, and the mean value of the <code>z</code> column of our data frame called <code>df_xyz</code>. We can do that manually like this using dollar sign notation:</p>
<div class="sourceCode" id="cb1295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1295-1"><a href="writing-for-loops.html#cb1295-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>## [1] 0.07462564</code></pre>
<div class="sourceCode" id="cb1297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1297-1"><a href="writing-for-loops.html#cb1297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.208622</code></pre>
<div class="sourceCode" id="cb1299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1299-1"><a href="writing-for-loops.html#cb1299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz<span class="sc">$</span>z)</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>Or, we’ve also learned how to get the same result using bracket notation:</p>
<div class="sourceCode" id="cb1301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1301-1"><a href="writing-for-loops.html#cb1301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="st">&quot;x&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] 0.07462564</code></pre>
<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1303-1"><a href="writing-for-loops.html#cb1303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="st">&quot;y&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] 0.208622</code></pre>
<div class="sourceCode" id="cb1305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1305-1"><a href="writing-for-loops.html#cb1305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="st">&quot;z&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>In the code above, we used the quoted column <em>names</em> inside the double brackets. However, we could have also used each column’s <em>position</em> inside the double brackets. In other words, we can use <code>1</code> to refer to the <code>x</code> column because it is the first column in the data frame, we can use <code>2</code> to refer to the <code>y</code> column because it is the second column in the data frame, and we can use <code>3</code> to refer to the <code>z</code> column because it is the third column in the data frame:</p>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1307-1"><a href="writing-for-loops.html#cb1307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] 0.07462564</code></pre>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1309-1"><a href="writing-for-loops.html#cb1309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1] 0.208622</code></pre>
<div class="sourceCode" id="cb1311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1311-1"><a href="writing-for-loops.html#cb1311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>For reasons that will become clearer later, this will actually be the syntax we want to use inside of our for loop.</p>
<p>Notice, however, the we copied the same code more than twice above. For all of the reasons we’ve already discussed, we would like to just type <code>mean(df_xyz[[ # ]]</code> once and have R fill in the number inside the double brackets for us, one after the other. As you’ve probably guessed, that’s exactly what the for loop does.</p>
</div>
<div id="the-for-function" class="section level3" number="35.1.2">
<h3><span class="header-section-number">35.1.2</span> The for() function</h3>
<p>All for loops start with the <code>for()</code> function. This is how you tell R that you are about to write a for loop.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/for.png" width="900" /></p>
<p>In the examples in this book, the arguments to the <code>for()</code> function are generally going to follow this pattern:</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/for2.png" width="900" /></p>
<p>1️⃣An index variable, which is also sometimes called a “counter,” to the left of the keyword <code>in</code>.</p>
<p>2️⃣The keyword <code>in</code>.</p>
<p>3️⃣The name of the object we want to loop (or iterate) over — often passed to the<code>seq_along()</code> function.</p>
<p>It can be a little intimidating to look at, but that’s the basic structure. We will talk about all three arguments simultaneously because they all work together, and we will get an error if we are missing any one of them:</p>
<div class="sourceCode" id="cb1313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1313-1"><a href="writing-for-loops.html#cb1313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No index variable</span></span>
<span id="cb1313-2"><a href="writing-for-loops.html#cb1313-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(<span class="cf">in</span> <span class="dv">1</span>) {</span>
<span id="cb1313-3"><a href="writing-for-loops.html#cb1313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1313-4"><a href="writing-for-loops.html#cb1313-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:2:5: unexpected &#39;in&#39;
## 1: # No index variable
## 2: for(in
##        ^</code></pre>
<div class="sourceCode" id="cb1315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1315-1"><a href="writing-for-loops.html#cb1315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No keyword &quot;in&quot;</span></span>
<span id="cb1315-2"><a href="writing-for-loops.html#cb1315-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="dv">1</span>) {</span>
<span id="cb1315-3"><a href="writing-for-loops.html#cb1315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1315-4"><a href="writing-for-loops.html#cb1315-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:2:7: unexpected numeric constant
## 1: # No keyword &quot;in&quot;
## 2: for(i 1
##          ^</code></pre>
<div class="sourceCode" id="cb1317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1317-1"><a href="writing-for-loops.html#cb1317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No object to loop over</span></span>
<span id="cb1317-2"><a href="writing-for-loops.html#cb1317-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> ) {</span>
<span id="cb1317-3"><a href="writing-for-loops.html#cb1317-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1317-4"><a href="writing-for-loops.html#cb1317-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:2:10: unexpected &#39;)&#39;
## 1: # No object to loop over
## 2: for(i in )
##             ^</code></pre>
<p>So, what happens when we do have all three of these components? Well, the index variable will take on each value of the object to loop over <em>iteratively</em> (i.e., one at a time). If there is only one object to loop over, this is how R sees the index variable inside of the loop:</p>
<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1319-1"><a href="writing-for-loops.html#cb1319-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span>) {</span>
<span id="cb1319-2"><a href="writing-for-loops.html#cb1319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1319-3"><a href="writing-for-loops.html#cb1319-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>If there are multiple objects to loop over, this is how R sees the index variable inside of the loop:</p>
<div class="sourceCode" id="cb1321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1321-1"><a href="writing-for-loops.html#cb1321-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb1321-2"><a href="writing-for-loops.html#cb1321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1321-3"><a href="writing-for-loops.html#cb1321-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<p>Notice that the values being printed out are <em>not</em> a single numeric vector with three elements (e.g. <code>[1] 1, 2, 3</code>) like the object we started with to the right of the keyword <code>in</code>. Instead, three vectors with one element each are being printed out. One for 1 (i.e., <code>[1] 1</code>), one for 2 (i.e., <code>[1] 2</code>), and one for 3 (i.e., <code>[1] 3</code>). I point this out because it illustrates the <em>iterative</em> nature of a for loop. What I mean is that the index variable doesn’t take on the values of the object to the right of the keyword <code>in</code> <em>simultaneously</em>. It takes them on <em>iteratively</em>, or separately, one after the other.</p>
<p>Further, it may not be immediately obvious at this point, but that’s the basic “magic” of the for loop. <em>The index variable changes once for each element of whatever object is on the right side of the keyword <code>in</code></em>. Even the most complicated for loops generally start from this basic idea.</p>
<p>As a quick sidebar, I want to point out that the index variable does not have to be the letter <code>i</code>. It can be any letter:</p>
<div class="sourceCode" id="cb1323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1323-1"><a href="writing-for-loops.html#cb1323-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb1323-2"><a href="writing-for-loops.html#cb1323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(x)</span>
<span id="cb1323-3"><a href="writing-for-loops.html#cb1323-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<p>Or even a word:</p>
<div class="sourceCode" id="cb1325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1325-1"><a href="writing-for-loops.html#cb1325-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(number <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb1325-2"><a href="writing-for-loops.html#cb1325-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(number)</span>
<span id="cb1325-3"><a href="writing-for-loops.html#cb1325-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<p>However, <code>i</code> is definitely the most common letter to use as the index variable and I’m going to suggest that you also use it in most cases. It’s just what people will expect to see and easily understand.</p>
<p>Now, let’s discuss the object to the right of the keyword <code>in</code>. In all of the examples above, we passed a vector to the right of the keyword <code>in</code>. As you saw, when there is a vector to the right of the keyword <code>in</code>, the index variable takes on the value of each element of the vector. However, the object to the right of the keyword <code>in</code> does not have to be a vector. In fact, it will often be a data frame.</p>
<p>When we ask the for loop to iterate over a data frame, what value do you think the index variable will take? The value of each cell of the data frame? The name or number of each column? The name or number of each row? Let’s see:</p>
<div class="sourceCode" id="cb1327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1327-1"><a href="writing-for-loops.html#cb1327-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> df_xyz) {</span>
<span id="cb1327-2"><a href="writing-for-loops.html#cb1327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1327-3"><a href="writing-for-loops.html#cb1327-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>##  [1] -0.56047565 -0.23017749  1.55870831  0.07050839  0.12928774  1.71506499  0.46091621 -1.26506123 -0.68685285 -0.44566197
##  [1]  1.2240818  0.3598138  0.4007715  0.1106827 -0.5558411  1.7869131  0.4978505 -1.9666172  0.7013559 -0.4727914
##  [1] -1.0678237 -0.2179749 -1.0260044 -0.7288912 -0.6250393 -1.6866933  0.8377870  0.1533731 -1.1381369  1.2538149</code></pre>
<p>It may not be totally obvious to you, but inside the for loop above, the index variable took on three separate <em>vectors</em> of values – one for each column in the data frame. Of course, getting the mean value of each of these <em>vectors</em> is equivalent to getting the mean value of each <em>column</em> in our data frame. Remember, data frame columns <em>are</em> vectors. So, let’s replace the <code>print()</code> function with the <code>mean()</code> function in the for loop body and see what happens:</p>
<div class="sourceCode" id="cb1329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1329-1"><a href="writing-for-loops.html#cb1329-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> df_xyz) {</span>
<span id="cb1329-2"><a href="writing-for-loops.html#cb1329-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(i)</span>
<span id="cb1329-3"><a href="writing-for-loops.html#cb1329-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Hmmm, it doesn’t seem as though anything happened. This is probably a good time to mention a little peculiarity about using for loops. As you can see in the example above, the return value of functions, and the contents of objects, referenced inside of the for loop body will not be printed to the screen unless we explicitly pass them to the <code>print()</code> function:</p>
<div class="sourceCode" id="cb1330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1330-1"><a href="writing-for-loops.html#cb1330-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> df_xyz) {</span>
<span id="cb1330-2"><a href="writing-for-loops.html#cb1330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">mean</span>(i))</span>
<span id="cb1330-3"><a href="writing-for-loops.html#cb1330-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.07462564
## [1] 0.208622
## [1] -0.4245589</code></pre>
<p>It worked! This is the exact same answer we got above. And, if all we want to do is print the mean values of <code>x</code>, <code>y</code>, and <code>z</code> to the screen, then we could stop here and call it a day. However, we often want to save our analysis results to an object. In the chapter on using column-wise operations with <code>dplyr</code>, we saved our summary statistics to an object in the usual way (i.e., with the assignment arrow):</p>
<div class="sourceCode" id="cb1332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1332-1"><a href="writing-for-loops.html#cb1332-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> df_xyz <span class="sc">%&gt;%</span></span>
<span id="cb1332-2"><a href="writing-for-loops.html#cb1332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1332-3"><a href="writing-for-loops.html#cb1332-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb1332-4"><a href="writing-for-loops.html#cb1332-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols  =</span> <span class="fu">everything</span>(),</span>
<span id="cb1332-5"><a href="writing-for-loops.html#cb1332-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns   =</span> mean,</span>
<span id="cb1332-6"><a href="writing-for-loops.html#cb1332-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">&quot;{col}_mean&quot;</span></span>
<span id="cb1332-7"><a href="writing-for-loops.html#cb1332-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1332-8"><a href="writing-for-loops.html#cb1332-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>From there, we can manipulate the results, save the results to a file, or print them to screen:</p>
<div class="sourceCode" id="cb1333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1333-1"><a href="writing-for-loops.html#cb1333-1" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   x_mean y_mean z_mean
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.0746  0.209 -0.425</code></pre>
<p>At first, it may seem as though we can assign the results of our for loop to an object in a similar way:</p>
<div class="sourceCode" id="cb1335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1335-1"><a href="writing-for-loops.html#cb1335-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="cf">for</span>(i <span class="cf">in</span> df_xyz) {</span>
<span id="cb1335-2"><a href="writing-for-loops.html#cb1335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(i)</span>
<span id="cb1335-3"><a href="writing-for-loops.html#cb1335-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1336-1"><a href="writing-for-loops.html#cb1336-1" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Unfortunately, this doesn’t work. Instead, we need to create an object that can store the results of our for loop. Then, we <em>update</em> (i.e., add to) that object at each iteration of the for loop. That brings us back to structure number 1.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/two_structures.png" width="900" /></p>
<p>Because the result of our for loop will be three numbers – the mean of <code>x</code>, the mean of <code>y</code>, and the mean of <code>z</code> – the most straightforward object to store them in is a numeric vector with a length of three (i.e., three “slots”). We can use the <code>vector()</code> function to create an empty vector:</p>
<div class="sourceCode" id="cb1338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1338-1"><a href="writing-for-loops.html#cb1338-1" aria-hidden="true" tabindex="-1"></a>my_vec <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb1338-2"><a href="writing-for-loops.html#cb1338-2" aria-hidden="true" tabindex="-1"></a>my_vec</span></code></pre></div>
<pre><code>## logical(0)</code></pre>
<p>As you can see, by default, the <code>vector()</code> function creates a logical vector with length zero. We can change the vector type to numeric by passing <code>"numeric"</code> to the <code>mode</code> argument of the <code>vector()</code> function. We can also change the length to 3 by passing <code>3</code> to the length argument of the <code>vector()</code> function, and because we know we want this vector to hold the mean values of <code>x</code>, <code>y</code>, and <code>z</code>, let’s name it <code>xyz_means</code>:</p>
<div class="sourceCode" id="cb1340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1340-1"><a href="writing-for-loops.html#cb1340-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)</span>
<span id="cb1340-2"><a href="writing-for-loops.html#cb1340-2" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<p>Finally, let’s update <code>xyz_means</code> inside our for loop body:</p>
<div class="sourceCode" id="cb1342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1342-1"><a href="writing-for-loops.html#cb1342-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> df_xyz) {</span>
<span id="cb1342-2"><a href="writing-for-loops.html#cb1342-2" aria-hidden="true" tabindex="-1"></a>  xyz_means <span class="ot">&lt;-</span> <span class="fu">mean</span>(i)</span>
<span id="cb1342-3"><a href="writing-for-loops.html#cb1342-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1343-1"><a href="writing-for-loops.html#cb1343-1" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>Hmmm, we’re getting closer, but that obviously still isn’t the result we want. Below, I try to illustrate what’s going on inside our loop.</p>
<p>R starts executing at the top of the for loop. In the first iteration, the value of i is set to a numeric vector with the same values as the <code>x</code> column in <code>df_xyz</code>. Then, the <code>i</code> in <code>mean(i)</code> inside the for loop body is replaced with those numeric values. Then, the mean of those numeric values is calculated and assigned to the object named <code>xyz_means</code>.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_1_1.png" width="900" /></p>
<p>At this point, there is no more code left to execute inside of the for loop, so R returns to the top of the loop.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_1_2.png" width="900" /></p>
<p><code>i</code> has not yet taken every value of the object to the right of the keyword <code>in</code>, so R starts another iteration of the for loop. In the second iteration, the value of <code>i</code> is set to a numeric vector with the same values as the <code>y</code> column in <code>df_xyz</code>. Then, the <code>i</code> in <code>mean(i)</code> inside the for loop body is replaced with those numeric values. Then, the mean of those numeric values is calculated and assigned to the object named <code>xyz_means</code>.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_1_3.png" width="900" /></p>
<p>At this point, there is no more code left to execute inside of the for loop, so R returns to the top of the loop.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_1_4.png" width="900" /></p>
<p><code>i</code> still has not yet taken every value of the object to the right of the keyword <code>in</code>, so R starts another iteration of the for loop. In the third iteration, the value of <code>i</code> is set to a numeric vector with the same values as the <code>z</code> column in <code>df_xyz</code>. Then, the <code>i</code> in <code>mean(i)</code> inside the for loop body is replaced with those numeric values. Then, the mean of those numeric values is calculated and assigned to the object named <code>xyz_means</code>.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_1_5.png" width="900" /></p>
<p>At this point, there is no more code left to execute inside of the for loop, so R returns to the top of the loop. However, this time, <code>i</code> has taken every value of the object to the right of the keyword <code>in</code>, so R does not start another iteration. It leaves the looping process, and the value of <code>xyz_means</code> remains <code>-0.4245589</code> – The result we got above.</p>
<p>You might be thinking, “wait, we made three slots in the <code>xyz_means</code> vector. Why does it only contain one number?” Well, remember that all we have to do to overwrite one object with another object is to assign the second object to the same name. For example, let’s create a vector with three values called <code>my_vec</code>:</p>
<div class="sourceCode" id="cb1345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1345-1"><a href="writing-for-loops.html#cb1345-1" aria-hidden="true" tabindex="-1"></a>my_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb1345-2"><a href="writing-for-loops.html#cb1345-2" aria-hidden="true" tabindex="-1"></a>my_vec</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>Now, let’s assign another value to <code>my_vec</code>:</p>
<div class="sourceCode" id="cb1347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1347-1"><a href="writing-for-loops.html#cb1347-1" aria-hidden="true" tabindex="-1"></a>my_vec <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.4245589</span></span>
<span id="cb1347-2"><a href="writing-for-loops.html#cb1347-2" aria-hidden="true" tabindex="-1"></a>my_vec</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>As you can see, assignment (<code>&lt;-</code>) doesn’t <em>add to</em> the vector, it <em>overwrites</em> (i.e., replaces) the vector. That’s exactly what was happening inside of our for loop. To R, it basically looked like this:</p>
<div class="sourceCode" id="cb1349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1349-1"><a href="writing-for-loops.html#cb1349-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fl">0.07462564</span></span>
<span id="cb1349-2"><a href="writing-for-loops.html#cb1349-2" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fl">0.208622</span></span>
<span id="cb1349-3"><a href="writing-for-loops.html#cb1349-3" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.4245589</span></span>
<span id="cb1349-4"><a href="writing-for-loops.html#cb1349-4" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>What we really want is to create the empty vector:</p>
<div class="sourceCode" id="cb1351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1351-1"><a href="writing-for-loops.html#cb1351-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)</span>
<span id="cb1351-2"><a href="writing-for-loops.html#cb1351-2" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<p>And then add a value to each <em>slot</em> in the vector. Do you remember how to do this?</p>
<p>We can do this using bracket notation:</p>
<div class="sourceCode" id="cb1353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1353-1"><a href="writing-for-loops.html#cb1353-1" aria-hidden="true" tabindex="-1"></a>xyz_means[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fl">0.07462564</span></span>
<span id="cb1353-2"><a href="writing-for-loops.html#cb1353-2" aria-hidden="true" tabindex="-1"></a>xyz_means[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fl">0.208622</span></span>
<span id="cb1353-3"><a href="writing-for-loops.html#cb1353-3" aria-hidden="true" tabindex="-1"></a>xyz_means[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.4245589</span></span>
<span id="cb1353-4"><a href="writing-for-loops.html#cb1353-4" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862200 -0.42455890</code></pre>
<p>That’s exactly the result we want.</p>
<p>Does that code above remind you of any other code we’ve already seen? How about this code:</p>
<div class="sourceCode" id="cb1355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1355-1"><a href="writing-for-loops.html#cb1355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] 0.07462564</code></pre>
<div class="sourceCode" id="cb1357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1357-1"><a href="writing-for-loops.html#cb1357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1] 0.208622</code></pre>
<div class="sourceCode" id="cb1359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1359-1"><a href="writing-for-loops.html#cb1359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df_xyz[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## [1] -0.4245589</code></pre>
<p>Hmmm, what if we combine the two? First, let’s once again create our empty vector, and then try combining the two code chunks above to fill it:</p>
<div class="sourceCode" id="cb1361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1361-1"><a href="writing-for-loops.html#cb1361-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)</span>
<span id="cb1361-2"><a href="writing-for-loops.html#cb1361-2" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<div class="sourceCode" id="cb1363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1363-1"><a href="writing-for-loops.html#cb1363-1" aria-hidden="true" tabindex="-1"></a>xyz_means[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[<span class="dv">1</span>]])</span>
<span id="cb1363-2"><a href="writing-for-loops.html#cb1363-2" aria-hidden="true" tabindex="-1"></a>xyz_means[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[<span class="dv">2</span>]])</span>
<span id="cb1363-3"><a href="writing-for-loops.html#cb1363-3" aria-hidden="true" tabindex="-1"></a>xyz_means[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[<span class="dv">3</span>]])</span>
<span id="cb1363-4"><a href="writing-for-loops.html#cb1363-4" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887</code></pre>
<p>Again, that’s exactly the result we want. Of course, there is still unnecessary repetition. If you look at the code carefully, you may notice that the only thing that changes from line to line is the number inside the double brackets. So, if we could just type <code>xyz_means[[ # ]] &lt;- mean(df_xyz[[ # ]])</code> once, and update the number inside the double brackets, we should be able to get the result we want. We’ve actually already seen how to do that with a for loop too. Remember this for loop for the very beginning of the chapter:</p>
<div class="sourceCode" id="cb1365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1365-1"><a href="writing-for-loops.html#cb1365-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb1365-2"><a href="writing-for-loops.html#cb1365-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb1365-3"><a href="writing-for-loops.html#cb1365-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<p>That looks promising, right? Let’s once again create our empty vector, and then try combining the two code chunks above to fill it:</p>
<div class="sourceCode" id="cb1367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1367-1"><a href="writing-for-loops.html#cb1367-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)</span>
<span id="cb1367-2"><a href="writing-for-loops.html#cb1367-2" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<div class="sourceCode" id="cb1369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1369-1"><a href="writing-for-loops.html#cb1369-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)) {</span>
<span id="cb1369-2"><a href="writing-for-loops.html#cb1369-2" aria-hidden="true" tabindex="-1"></a>  xyz_means[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[i]])</span>
<span id="cb1369-3"><a href="writing-for-loops.html#cb1369-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1370-1"><a href="writing-for-loops.html#cb1370-1" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887</code></pre>
<p>It works! We have used a for loop to successfully remove the unnecessary repetition from our code. However, there’s still something we could do to make the code more robust. In the for loop above, we knew that we needed three iterations. Therefore, we passed <code>c(1, 2, 3)</code> as the object to the right of the keyword <code>in</code>. But, what if we didn’t know exactly how columns there were? What if we just knew that we wanted to iterate over all the columns in the data frame passed to the right of the keyword <code>in</code>. How could we do that?</p>
<p>We can do that with the <code>seq_along()</code> function. When we pass a vector to the <code>seq_along()</code> function, it returns a sequence of integers with the same length as the vector being passed, starting at one. For example:</p>
<div class="sourceCode" id="cb1372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1372-1"><a href="writing-for-loops.html#cb1372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq_along</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>Or:</p>
<div class="sourceCode" id="cb1374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1374-1"><a href="writing-for-loops.html#cb1374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq_along</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>Similarly, when we pass a data frame to the <code>seq_along()</code> function, it returns a sequence of integers with a length equal to the number of columns in the data frame being passed, starting at one. For example:</p>
<div class="sourceCode" id="cb1376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1376-1"><a href="writing-for-loops.html#cb1376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq_along</span>(df_xyz)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>Therefore, we can replace <code>for(i in c(1, 2, 3))</code> with <code>for(i in seq_along(df_xyz))</code> to make our code more robust (i.e., it will work in more situations):</p>
<div class="sourceCode" id="cb1378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1378-1"><a href="writing-for-loops.html#cb1378-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)</span>
<span id="cb1378-2"><a href="writing-for-loops.html#cb1378-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1378-3"><a href="writing-for-loops.html#cb1378-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(df_xyz)) {</span>
<span id="cb1378-4"><a href="writing-for-loops.html#cb1378-4" aria-hidden="true" tabindex="-1"></a>  xyz_means[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[i]])</span>
<span id="cb1378-5"><a href="writing-for-loops.html#cb1378-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1378-6"><a href="writing-for-loops.html#cb1378-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1378-7"><a href="writing-for-loops.html#cb1378-7" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887</code></pre>
<p>Just to make sure that we really understand what’s going on in the code above, let’s walk through the entire process one more time.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_2_1.png" width="900" /></p>
<p>R starts executing at the top of the for loop. In the first iteration, the value of i is set to the first value in <code>seq_along(df_xyz)</code>, which is <code>1</code>. Then, the <code>i</code> in <code>df_xyz[[i]]</code> inside the for loop body is replaced with <code>1</code>. Then, R calculates the mean of <code>df_xyz[[1]]</code>, which is <code>x</code> column of the <code>df_xyz</code> data frame. Finally, the mean value is assigned to <code>xyz_means[[i]]</code>, which is <code>xyz_means[[1]]</code> in this iteration. So, the value of the first element in the <code>xyz_means</code> vector is <code>0.07462564</code>.</p>
<p>At this point, there is no more code left to execute inside of the for loop, so R returns to the top of the loop. <code>i</code> has not yet taken every value of the object to the right of the keyword <code>in</code>, so R starts another iteration of the for loop.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_2_2.png" width="900" /></p>
<p>In the second iteration, the value of i is set to the second value in <code>seq_along(df_xyz)</code>, which is <code>2</code>. Then, the <code>i</code> in <code>df_xyz[[i]]</code> inside the for loop body is replaced with <code>2</code>. Then, R calculates the mean of <code>df_xyz[[2]]</code>, which is <code>y</code> column of the <code>df_xyz</code> data frame. Finally, the mean value is assigned to <code>xyz_means[[i]]</code>, which is <code>xyz_means[[2]]</code> in this iteration. So, the value of the second element in the <code>xyz_means</code> vector is <code>0.20862196</code>.</p>
<p>At this point, there is no more code left to execute inside of the for loop, so R returns to the top of the loop. <code>i</code> still has not yet taken every value of the object to the right of the keyword <code>in</code>, so R starts another iteration of the for loop.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_2_3.png" width="900" /></p>
<p>In the third iteration, the value of i is set to the third value in <code>seq_along(df_xyz)</code>, which is <code>3</code>. Then, the <code>i</code> in <code>df_xyz[[i]]</code> inside the for loop body is replaced with <code>3</code>. Then, R calculates the mean of <code>df_xyz[[3]]</code>, which is <code>z</code> column of the <code>df_xyz</code> data frame. Finally, the mean value is assigned to <code>xyz_means[[i]]</code>, which is <code>xyz_means[[3]]</code> in this iteration. So, the value of the third element in the <code>xyz_means</code> vector is <code>-0.42455887</code>.</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/iteration_1_5.png" width="900" /></p>
<p>At this point, there is no more code left to execute inside of the for loop, so R returns to the top of the loop. However, this time, <code>i</code> has taken every value of the object to the right of the keyword <code>in</code>, so R does not start another iteration. It leaves the looping process, and the value of <code>xyz_means</code> remains <code>0.07462564, 0.20862196, -0.4245589</code>.</p>
<p>There’s one final adjustment we should probably make to the code above. Did you notice that when we create the empty vector to contain our results, we’re still hard coding its length to <code>3</code>? For the same reason we replaced <code>for(i in c(1, 2, 3))</code> with <code>for(i in seq_along(df_xyz))</code>, we want to replace <code>vector("numeric", 3)</code> with <code>vector("numeric", length(df_xyz))</code>.</p>
<p>Now, let’s add a fourth column to our data frame:</p>
<div class="sourceCode" id="cb1380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1380-1"><a href="writing-for-loops.html#cb1380-1" aria-hidden="true" tabindex="-1"></a>df_xyz <span class="ot">&lt;-</span> df_xyz <span class="sc">%&gt;%</span> </span>
<span id="cb1380-2"><a href="writing-for-loops.html#cb1380-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1380-3"><a href="writing-for-loops.html#cb1380-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##          x      y      z       a
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1 -0.560   1.22  -1.07   0.426 
##  2 -0.230   0.360 -0.218 -0.295 
##  3  1.56    0.401 -1.03   0.895 
##  4  0.0705  0.111 -0.729  0.878 
##  5  0.129  -0.556 -0.625  0.822 
##  6  1.72    1.79  -1.69   0.689 
##  7  0.461   0.498  0.838  0.554 
##  8 -1.27   -1.97   0.153 -0.0619
##  9 -0.687   0.701 -1.14  -0.306 
## 10 -0.446  -0.473  1.25  -0.380</code></pre>
<p>And see what happens when we pass it to our new, robust for loop code:</p>
<div class="sourceCode" id="cb1382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1382-1"><a href="writing-for-loops.html#cb1382-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="fu">length</span>(df_xyz)) <span class="co"># Using length() instead of 3</span></span>
<span id="cb1382-2"><a href="writing-for-loops.html#cb1382-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1382-3"><a href="writing-for-loops.html#cb1382-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(df_xyz)) { <span class="co"># Using seq_along() instead of c(1, 2, 3)</span></span>
<span id="cb1382-4"><a href="writing-for-loops.html#cb1382-4" aria-hidden="true" tabindex="-1"></a>  xyz_means[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[i]])</span>
<span id="cb1382-5"><a href="writing-for-loops.html#cb1382-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1382-6"><a href="writing-for-loops.html#cb1382-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1382-7"><a href="writing-for-loops.html#cb1382-7" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887  0.32204455</code></pre>
<p>Our for loop now gives us the result we want no matter how many columns are in the data frame. Having the flexibility to loop over an arbitrary number of columns wasn’t that important in this case – we knew exactly how many columns we wanted to loop over. However, what if we wanted to add more columns in the future? Using the second method, we wouldn’t have to make any changes to our code. This is often an important consideration when we embed for loops inside of functions that we write ourselves.</p>
<p>For example, maybe we think, “that for loop above was really useful. I want to write it into a function so that I can use it again in my other projects.” Well, we’ve already seen how to take our working code, embed it inside of a function, make it more general, and assign it a name. If you forgot how to do this, please review <a href="writing-functions.html#the-function-writing-process">the function writing process</a>. In this case, that process would result in something like this:</p>
<div class="sourceCode" id="cb1384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1384-1"><a href="writing-for-loops.html#cb1384-1" aria-hidden="true" tabindex="-1"></a>multi_means <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb1384-2"><a href="writing-for-loops.html#cb1384-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a structure to contain results</span></span>
<span id="cb1384-3"><a href="writing-for-loops.html#cb1384-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="fu">length</span>(data))</span>
<span id="cb1384-4"><a href="writing-for-loops.html#cb1384-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1384-5"><a href="writing-for-loops.html#cb1384-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over each column of data</span></span>
<span id="cb1384-6"><a href="writing-for-loops.html#cb1384-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(data)) {</span>
<span id="cb1384-7"><a href="writing-for-loops.html#cb1384-7" aria-hidden="true" tabindex="-1"></a>    result[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data[[i]])</span>
<span id="cb1384-8"><a href="writing-for-loops.html#cb1384-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1384-9"><a href="writing-for-loops.html#cb1384-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1384-10"><a href="writing-for-loops.html#cb1384-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the result</span></span>
<span id="cb1384-11"><a href="writing-for-loops.html#cb1384-11" aria-hidden="true" tabindex="-1"></a>  result</span>
<span id="cb1384-12"><a href="writing-for-loops.html#cb1384-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Which we can easily apply to our data frame like this:</p>
<div class="sourceCode" id="cb1385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1385-1"><a href="writing-for-loops.html#cb1385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multi_means</span>(df_xyz)</span></code></pre></div>
<pre><code>## [1]  0.07462564  0.20862196 -0.42455887  0.32204455</code></pre>
<p>Further, because we’ve made the for loop code inside of the function body flexible with <code>length()</code> and <code>seq_along()</code> we can easily pass any other data frame (with all numeric columns) to our function like this:</p>
<div class="sourceCode" id="cb1387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1387-1"><a href="writing-for-loops.html#cb1387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1387-2"><a href="writing-for-loops.html#cb1387-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1387-3"><a href="writing-for-loops.html#cb1387-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age    =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb1387-4"><a href="writing-for-loops.html#cb1387-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">65</span>, <span class="dv">5</span>),</span>
<span id="cb1387-5"><a href="writing-for-loops.html#cb1387-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">165</span>, <span class="dv">10</span>)</span>
<span id="cb1387-6"><a href="writing-for-loops.html#cb1387-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1387-7"><a href="writing-for-loops.html#cb1387-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##      age height weight
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  44.4   71.1   154.
##  2  47.7   66.8   163.
##  3  65.6   67.0   155.
##  4  50.7   65.6   158.
##  5  51.3   62.2   159.
##  6  67.2   73.9   148.
##  7  54.6   67.5   173.
##  8  37.3   55.2   167.
##  9  43.1   68.5   154.
## 10  45.5   62.6   178.</code></pre>
<div class="sourceCode" id="cb1389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1389-1"><a href="writing-for-loops.html#cb1389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multi_means</span>(new_df)</span></code></pre></div>
<pre><code>## [1]  50.74626  66.04311 160.75441</code></pre>
<p>If we want our for loop to return the results with informative names, similar those that are returned when we use the <code>across()</code> method, we can simply add one line of code to our for loop body that names each result:</p>
<div class="sourceCode" id="cb1391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1391-1"><a href="writing-for-loops.html#cb1391-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="fu">length</span>(df_xyz))</span>
<span id="cb1391-2"><a href="writing-for-loops.html#cb1391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1391-3"><a href="writing-for-loops.html#cb1391-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(df_xyz)) {</span>
<span id="cb1391-4"><a href="writing-for-loops.html#cb1391-4" aria-hidden="true" tabindex="-1"></a>  xyz_means[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_xyz[[i]])</span>
<span id="cb1391-5"><a href="writing-for-loops.html#cb1391-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(xyz_means)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(df_xyz)[[i]], <span class="st">&quot;_mean&quot;</span>) <span class="co"># Name results here</span></span>
<span id="cb1391-6"><a href="writing-for-loops.html#cb1391-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1391-7"><a href="writing-for-loops.html#cb1391-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1391-8"><a href="writing-for-loops.html#cb1391-8" aria-hidden="true" tabindex="-1"></a>xyz_means</span></code></pre></div>
<pre><code>##      x_mean      y_mean      z_mean      a_mean 
##  0.07462564  0.20862196 -0.42455887  0.32204455</code></pre>
<p>If it isn’t quite clear to you why that code works, try picking it apart, replacing <code>i</code> with a number, and figuring out how it works.</p>
<p>We can make our results resemble those returned by the <code>across()</code> method even more by converting our named vector to a data frame like this:</p>
<div class="sourceCode" id="cb1393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1393-1"><a href="writing-for-loops.html#cb1393-1" aria-hidden="true" tabindex="-1"></a>xyz_means <span class="sc">%&gt;%</span> </span>
<span id="cb1393-2"><a href="writing-for-loops.html#cb1393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1393-3"><a href="writing-for-loops.html#cb1393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   x_mean y_mean z_mean a_mean
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.0746  0.209 -0.425  0.322</code></pre>
<p>Finally, we can update our <code>multi_means()</code> function with changes we made above so that our results are returned as a data frame with informative column names:</p>
<div class="sourceCode" id="cb1395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1395-1"><a href="writing-for-loops.html#cb1395-1" aria-hidden="true" tabindex="-1"></a>multi_means <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb1395-2"><a href="writing-for-loops.html#cb1395-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a structure to contain results</span></span>
<span id="cb1395-3"><a href="writing-for-loops.html#cb1395-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="fu">length</span>(data))</span>
<span id="cb1395-4"><a href="writing-for-loops.html#cb1395-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1395-5"><a href="writing-for-loops.html#cb1395-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over each column of data</span></span>
<span id="cb1395-6"><a href="writing-for-loops.html#cb1395-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(data)) {</span>
<span id="cb1395-7"><a href="writing-for-loops.html#cb1395-7" aria-hidden="true" tabindex="-1"></a>    result[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data[[i]])</span>
<span id="cb1395-8"><a href="writing-for-loops.html#cb1395-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(result)[[i]] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(data)[[i]], <span class="st">&quot;_mean&quot;</span>)</span>
<span id="cb1395-9"><a href="writing-for-loops.html#cb1395-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1395-10"><a href="writing-for-loops.html#cb1395-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1395-11"><a href="writing-for-loops.html#cb1395-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the result as a tibble</span></span>
<span id="cb1395-12"><a href="writing-for-loops.html#cb1395-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="fu">as.list</span>(result))</span>
<span id="cb1395-13"><a href="writing-for-loops.html#cb1395-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1396-1"><a href="writing-for-loops.html#cb1396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multi_means</span>(new_df)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   age_mean height_mean weight_mean
##      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1     50.7        66.0        161.</code></pre>
</div>
</div>
<div id="using-for-loops-for-data-transfer" class="section level2" number="35.2">
<h2><span class="header-section-number">35.2</span> Using for loops for data transfer</h2>
<p>In the previous section, we used an example that wasn’t really all that realistic, but it was useful (hopefully) for learning the mechanics of for loops. As I said at the beginning of the chapter, I personally wouldn’t use a for loop for the analysis above. I would probably use <code>across()</code> with <code>summarise()</code>.</p>
<p>However, keep in mind that <code>across()</code> is designed specifically for repeatedly applying functions column-wise (i.e., across columns) of a <em>single</em> data frame in conjunction with <code>dplyr</code> verbs. By definition, if we are repeating code outside of <code>dplyr</code>, or if we are applying code across <em>multiple data frames</em>, then we probably aren’t going to be able to use <code>across()</code> to complete our coding task.</p>
<p>For example, let’s say that we have data stored across multiple sheets of an Excel workbook. This simulated data contains some demographic information about three different cities: Houston, Atlanta, and Charlotte. We need to import each sheet, clean the data, and combine them into a single data frame in order to complete our analysis. First, we will load the <code>readxl</code> package:</p>
<div class="sourceCode" id="cb1398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1398-1"><a href="writing-for-loops.html#cb1398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
<p><a href="https://www.dropbox.com/s/6nt00hmdzfdigp3/city_ses.xlsx?dl=1">You may click here to download this file to your computer.</a></p>
<p>Then, we may import each sheet like this:</p>
<div class="sourceCode" id="cb1399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1399-1"><a href="writing-for-loops.html#cb1399-1" aria-hidden="true" tabindex="-1"></a>houston <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1399-2"><a href="writing-for-loops.html#cb1399-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/Users/bradcannell/Dropbox/Datasets/Cities SES/city_ses.xlsx&quot;</span>,</span>
<span id="cb1399-3"><a href="writing-for-loops.html#cb1399-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;Houston&quot;</span></span>
<span id="cb1399-4"><a href="writing-for-loops.html#cb1399-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1399-5"><a href="writing-for-loops.html#cb1399-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex   ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 001      13 F            88
## 2 003      13 F            78
## 3 007      14 M            83
## 4 014      12 F            76
## 5 036      13 M            84</code></pre>
<div class="sourceCode" id="cb1401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1401-1"><a href="writing-for-loops.html#cb1401-1" aria-hidden="true" tabindex="-1"></a>atlanta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1401-2"><a href="writing-for-loops.html#cb1401-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/Users/bradcannell/Dropbox/Datasets/Cities SES/city_ses.xlsx&quot;</span>,</span>
<span id="cb1401-3"><a href="writing-for-loops.html#cb1401-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;Atlanta&quot;</span></span>
<span id="cb1401-4"><a href="writing-for-loops.html#cb1401-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1401-5"><a href="writing-for-loops.html#cb1401-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<div class="sourceCode" id="cb1403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1403-1"><a href="writing-for-loops.html#cb1403-1" aria-hidden="true" tabindex="-1"></a>charlotte <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1403-2"><a href="writing-for-loops.html#cb1403-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;/Users/bradcannell/Dropbox/Datasets/Cities SES/city_ses.xlsx&quot;</span>,</span>
<span id="cb1403-3"><a href="writing-for-loops.html#cb1403-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">&quot;Charlotte&quot;</span></span>
<span id="cb1403-4"><a href="writing-for-loops.html#cb1403-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1403-5"><a href="writing-for-loops.html#cb1403-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex     ses
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 004      13 F        84
## 2 011      14 M        66
## 3 018      12 M        92
## 4 023      12 M        89
## 5 030      13 F        83</code></pre>
<p>🚩In the code chunks above, we have essentially the same code copied more than twice. That’s a red flag that we should be thinking about removing unnecessary repetition from our code. Of course, we could write our own function to reduce some of the repetition:</p>
<div class="sourceCode" id="cb1405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1405-1"><a href="writing-for-loops.html#cb1405-1" aria-hidden="true" tabindex="-1"></a>import_cities <span class="ot">&lt;-</span> <span class="cf">function</span>(sheet) {</span>
<span id="cb1405-2"><a href="writing-for-loops.html#cb1405-2" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb1405-3"><a href="writing-for-loops.html#cb1405-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;/Users/bradcannell/Dropbox/Datasets/Cities SES/city_ses.xlsx&quot;</span>,</span>
<span id="cb1405-4"><a href="writing-for-loops.html#cb1405-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet =</span> sheet</span>
<span id="cb1405-5"><a href="writing-for-loops.html#cb1405-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1405-6"><a href="writing-for-loops.html#cb1405-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1406-1"><a href="writing-for-loops.html#cb1406-1" aria-hidden="true" tabindex="-1"></a>houston <span class="ot">&lt;-</span> <span class="fu">import_cities</span>(<span class="st">&quot;Houston&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex   ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 001      13 F            88
## 2 003      13 F            78
## 3 007      14 M            83
## 4 014      12 F            76
## 5 036      13 M            84</code></pre>
<div class="sourceCode" id="cb1408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1408-1"><a href="writing-for-loops.html#cb1408-1" aria-hidden="true" tabindex="-1"></a>atlanta <span class="ot">&lt;-</span> <span class="fu">import_cities</span>(<span class="st">&quot;Atlanta&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<div class="sourceCode" id="cb1410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1410-1"><a href="writing-for-loops.html#cb1410-1" aria-hidden="true" tabindex="-1"></a>charlotte <span class="ot">&lt;-</span> <span class="fu">import_cities</span>(<span class="st">&quot;Charlotte&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex     ses
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 004      13 F        84
## 2 011      14 M        66
## 3 018      12 M        92
## 4 023      12 M        89
## 5 030      13 F        83</code></pre>
<p>That method is better. And depending on the circumstances of your project, it may be the best approach. However, an alternative approach would be to use a for loop. Using the for loop approach might look something like this:</p>
<div class="sourceCode" id="cb1412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1412-1"><a href="writing-for-loops.html#cb1412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the file path to an object so we don&#39;t have to type it repeatedly </span></span>
<span id="cb1412-2"><a href="writing-for-loops.html#cb1412-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or hard-code it in.</span></span>
<span id="cb1412-3"><a href="writing-for-loops.html#cb1412-3" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;/Users/bradcannell/Dropbox/Datasets/Cities SES/city_ses.xlsx&quot;</span></span>
<span id="cb1412-4"><a href="writing-for-loops.html#cb1412-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1412-5"><a href="writing-for-loops.html#cb1412-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use readxl::excel_sheets to get the name of each sheet in the workbook.</span></span>
<span id="cb1412-6"><a href="writing-for-loops.html#cb1412-6" aria-hidden="true" tabindex="-1"></a><span class="co"># this makes our code more robust.</span></span>
<span id="cb1412-7"><a href="writing-for-loops.html#cb1412-7" aria-hidden="true" tabindex="-1"></a>sheets <span class="ot">&lt;-</span> <span class="fu">excel_sheets</span>(path)</span>
<span id="cb1412-8"><a href="writing-for-loops.html#cb1412-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1412-9"><a href="writing-for-loops.html#cb1412-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(sheets)) {</span>
<span id="cb1412-10"><a href="writing-for-loops.html#cb1412-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert sheet name to lowercase before using it to name the df</span></span>
<span id="cb1412-11"><a href="writing-for-loops.html#cb1412-11" aria-hidden="true" tabindex="-1"></a>  new_nm <span class="ot">&lt;-</span> <span class="fu">tolower</span>(sheets[[i]])</span>
<span id="cb1412-12"><a href="writing-for-loops.html#cb1412-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(new_nm, <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> sheets[[i]]))</span>
<span id="cb1412-13"><a href="writing-for-loops.html#cb1412-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1413-1"><a href="writing-for-loops.html#cb1413-1" aria-hidden="true" tabindex="-1"></a>houston</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex   ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
## 1 001      13 F            88
## 2 003      13 F            78
## 3 007      14 M            83
## 4 014      12 F            76
## 5 036      13 M            84</code></pre>
<div class="sourceCode" id="cb1415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1415-1"><a href="writing-for-loops.html#cb1415-1" aria-hidden="true" tabindex="-1"></a>atlanta</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   id      age gender ses_score
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 002      14 M             64
## 2 009      15 M             35
## 3 012      13 F             70
## 4 013      13 F             66
## 5 022      12 F             59</code></pre>
<div class="sourceCode" id="cb1417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1417-1"><a href="writing-for-loops.html#cb1417-1" aria-hidden="true" tabindex="-1"></a>charlotte</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   pid     age sex     ses
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 004      13 F        84
## 2 011      14 M        66
## 3 018      12 M        92
## 4 023      12 M        89
## 5 030      13 F        83</code></pre>
<p>👆<strong>Here’s what we did above:</strong></p>
<ul>
<li><p>We used a for loop to import every sheet from an Excel workbook.</p></li>
<li><p>First, we saved the path to the Excel workbook to a separate object. We didn’t have to do this. However, doing so prevented us from having to type out the full file path repeatedly in the rest of our code. Additionally, if the file path ever changed, we would only have to update it in one place.</p></li>
<li><p>Second, we used the <code>excel_sheets()</code> function to create a character vector containing each sheet name. We didn’t have to do this. We could have typed each sheet name manually. However, there shouldn’t be any accidental typos if we use the <code>excel_sheets()</code> function, and we don’t have to make any changes to our code if more sheets are added to the Workbook in the future.</p></li>
<li><p>Inside the for loop, we assigned each data frame created by the <code>read_excel()</code> function to our global environment using the <code>assign()</code> function. We haven’t used the <code>assign()</code> function before, but you can read the help documentation by typing <code>?assign</code> in your R console.</p>
<ul>
<li><p>The first argument to the <code>assign()</code> function is <code>x</code>. The value you pass to <code>x</code> should be the name of the object you want to create. Above, we passed <code>new_nm</code> (for new name) to the <code>x</code> argument. At each iteration of the for loop, <code>new_nm</code> contained the name of each sheet in <code>sheets</code>. So, <code>Houston</code> at the first iteration, <code>Atlanta</code> at the second iteration, and <code>Charlotte</code> at the third iteration. Of course, we like using lowercase names for our data frames, so we used <code>tolower()</code> to convert <code>Houston</code>, <code>Atlanta</code>, and <code>Charlotte</code> to <code>houston</code>, <code>atlanta</code>, and <code>charlotte</code>. These will be the names used for each data frame assigned to our global environment inside of the for loop.</p></li>
<li><p>The second argument to the <code>assign()</code> function is <code>value</code>. The value you pass to <code>value</code> should be the contents you want to assign the object with the name you passed to the <code>x</code> argument. Above, we passed the code that imports each sheet of the <code>city_ses.xlsx</code> data frame to the <code>value</code> argument.</p></li>
</ul></li>
</ul>
<p>For loops can often be helpful for data transfer tasks. In the code above, we looped over sheets of a single Excel workbook. However, we could have similarly looped over file paths to import multiple different Excel workbooks instead. We could have even used nested for loops to import multiple sheets from multiple Excel workbooks. The code would not have looked drastically different.</p>
</div>
<div id="using-for-loops-for-data-management" class="section level2" number="35.3">
<h2><span class="header-section-number">35.3</span> Using for loops for data management</h2>
<p>In the <a href="writing-functions.html#the-function-writing-process">chapter on writing functions</a>, we created an <code>is_match()</code> function. In that scenario, we wanted to see if first name, last name, and street name matched at each ID between our data frames. More specifically, we wanted to combine the two data frames into a single data frame and create three new dummy variables that indicated whether first name, last name, and address matched respectively.</p>
<p>Here are the data frames we simulated and combined:</p>
<div class="sourceCode" id="cb1419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1419-1"><a href="writing-for-loops.html#cb1419-1" aria-hidden="true" tabindex="-1"></a>people_1 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1419-2"><a href="writing-for-loops.html#cb1419-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>id_1, <span class="sc">~</span>name_first_1, <span class="sc">~</span>name_last_1, <span class="sc">~</span>street_1,</span>
<span id="cb1419-3"><a href="writing-for-loops.html#cb1419-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,     <span class="st">&quot;Easton&quot;</span>,      <span class="cn">NA</span>,           <span class="st">&quot;Alameda&quot;</span>,</span>
<span id="cb1419-4"><a href="writing-for-loops.html#cb1419-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>,     <span class="st">&quot;Elias&quot;</span>,       <span class="st">&quot;Salazar&quot;</span>,    <span class="st">&quot;Crissy Field&quot;</span>,</span>
<span id="cb1419-5"><a href="writing-for-loops.html#cb1419-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>,     <span class="st">&quot;Colton&quot;</span>,      <span class="st">&quot;Fox&quot;</span>,        <span class="st">&quot;San Bruno&quot;</span>,</span>
<span id="cb1419-6"><a href="writing-for-loops.html#cb1419-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>,     <span class="st">&quot;Cameron&quot;</span>,     <span class="st">&quot;Warren&quot;</span>,     <span class="st">&quot;Nottingham&quot;</span>,</span>
<span id="cb1419-7"><a href="writing-for-loops.html#cb1419-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>,     <span class="st">&quot;Carson&quot;</span>,      <span class="st">&quot;Mills&quot;</span>,      <span class="st">&quot;Jersey&quot;</span>,</span>
<span id="cb1419-8"><a href="writing-for-loops.html#cb1419-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>,     <span class="st">&quot;Addison&quot;</span>,     <span class="st">&quot;Meyer&quot;</span>,      <span class="st">&quot;Tingley&quot;</span>,</span>
<span id="cb1419-9"><a href="writing-for-loops.html#cb1419-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>,     <span class="st">&quot;Aubrey&quot;</span>,      <span class="st">&quot;Rice&quot;</span>,       <span class="st">&quot;Buena Vista&quot;</span>,</span>
<span id="cb1419-10"><a href="writing-for-loops.html#cb1419-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">8</span>,     <span class="st">&quot;Ellie&quot;</span>,       <span class="st">&quot;Schmidt&quot;</span>,    <span class="st">&quot;Division&quot;</span>,</span>
<span id="cb1419-11"><a href="writing-for-loops.html#cb1419-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">9</span>,     <span class="st">&quot;Robert&quot;</span>,      <span class="st">&quot;Garza&quot;</span>,      <span class="st">&quot;Red Rock&quot;</span>,</span>
<span id="cb1419-12"><a href="writing-for-loops.html#cb1419-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>,    <span class="st">&quot;Stella&quot;</span>,      <span class="st">&quot;Daniels&quot;</span>,    <span class="st">&quot;Holland&quot;</span></span>
<span id="cb1419-13"><a href="writing-for-loops.html#cb1419-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1420-1"><a href="writing-for-loops.html#cb1420-1" aria-hidden="true" tabindex="-1"></a>people_2 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1420-2"><a href="writing-for-loops.html#cb1420-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>id_2, <span class="sc">~</span>name_first_2, <span class="sc">~</span>name_last_2, <span class="sc">~</span>street_2,</span>
<span id="cb1420-3"><a href="writing-for-loops.html#cb1420-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,     <span class="st">&quot;Easton&quot;</span>,      <span class="st">&quot;Stone&quot;</span>,      <span class="st">&quot;Alameda&quot;</span>,</span>
<span id="cb1420-4"><a href="writing-for-loops.html#cb1420-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>,     <span class="st">&quot;Elas&quot;</span>,        <span class="st">&quot;Salazar&quot;</span>,    <span class="st">&quot;Field&quot;</span>,</span>
<span id="cb1420-5"><a href="writing-for-loops.html#cb1420-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span>,     <span class="cn">NA</span>,            <span class="st">&quot;Fox&quot;</span>,        <span class="cn">NA</span>,</span>
<span id="cb1420-6"><a href="writing-for-loops.html#cb1420-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>,     <span class="st">&quot;Cameron&quot;</span>,     <span class="st">&quot;Waren&quot;</span>,      <span class="st">&quot;Notingham&quot;</span>,</span>
<span id="cb1420-7"><a href="writing-for-loops.html#cb1420-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>,     <span class="st">&quot;Carsen&quot;</span>,      <span class="st">&quot;Mills&quot;</span>,      <span class="st">&quot;Jersey&quot;</span>,</span>
<span id="cb1420-8"><a href="writing-for-loops.html#cb1420-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>,     <span class="st">&quot;Adison&quot;</span>,      <span class="cn">NA</span>,           <span class="cn">NA</span>,</span>
<span id="cb1420-9"><a href="writing-for-loops.html#cb1420-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>,     <span class="st">&quot;Aubrey&quot;</span>,      <span class="st">&quot;Rice&quot;</span>,       <span class="st">&quot;Buena Vista&quot;</span>,</span>
<span id="cb1420-10"><a href="writing-for-loops.html#cb1420-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">8</span>,     <span class="cn">NA</span>,            <span class="st">&quot;Schmidt&quot;</span>,    <span class="st">&quot;Division&quot;</span>,</span>
<span id="cb1420-11"><a href="writing-for-loops.html#cb1420-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">9</span>,     <span class="st">&quot;Bob&quot;</span>,         <span class="st">&quot;Garza&quot;</span>,      <span class="st">&quot;Red Rock&quot;</span>,</span>
<span id="cb1420-12"><a href="writing-for-loops.html#cb1420-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>,    <span class="st">&quot;Stella&quot;</span>,      <span class="cn">NA</span>,           <span class="st">&quot;Holland&quot;</span></span>
<span id="cb1420-13"><a href="writing-for-loops.html#cb1420-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1421-1"><a href="writing-for-loops.html#cb1421-1" aria-hidden="true" tabindex="-1"></a>people <span class="ot">&lt;-</span> people_1 <span class="sc">%&gt;%</span> </span>
<span id="cb1421-2"><a href="writing-for-loops.html#cb1421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(people_2) <span class="sc">%&gt;%</span> </span>
<span id="cb1421-3"><a href="writing-for-loops.html#cb1421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##     id_1 name_first_1 name_last_1 street_1      id_2 name_first_2 name_last_2 street_2   
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      
##  1     1 Easton       &lt;NA&gt;        Alameda          1 Easton       Stone       Alameda    
##  2     2 Elias        Salazar     Crissy Field     2 Elas         Salazar     Field      
##  3     3 Colton       Fox         San Bruno        3 &lt;NA&gt;         Fox         &lt;NA&gt;       
##  4     4 Cameron      Warren      Nottingham       4 Cameron      Waren       Notingham  
##  5     5 Carson       Mills       Jersey           5 Carsen       Mills       Jersey     
##  6     6 Addison      Meyer       Tingley          6 Adison       &lt;NA&gt;        &lt;NA&gt;       
##  7     7 Aubrey       Rice        Buena Vista      7 Aubrey       Rice        Buena Vista
##  8     8 Ellie        Schmidt     Division         8 &lt;NA&gt;         Schmidt     Division   
##  9     9 Robert       Garza       Red Rock         9 Bob          Garza       Red Rock   
## 10    10 Stella       Daniels     Holland         10 Stella       &lt;NA&gt;        Holland</code></pre>
<p>Here is the function we wrote to help us create the dummy variables:</p>
<div class="sourceCode" id="cb1423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1423-1"><a href="writing-for-loops.html#cb1423-1" aria-hidden="true" tabindex="-1"></a>is_match <span class="ot">&lt;-</span> <span class="cf">function</span>(value_1, value_2) {</span>
<span id="cb1423-2"><a href="writing-for-loops.html#cb1423-2" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> value_1 <span class="sc">==</span> value_2</span>
<span id="cb1423-3"><a href="writing-for-loops.html#cb1423-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(result), <span class="cn">FALSE</span>, result)</span>
<span id="cb1423-4"><a href="writing-for-loops.html#cb1423-4" aria-hidden="true" tabindex="-1"></a>  result</span>
<span id="cb1423-5"><a href="writing-for-loops.html#cb1423-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is how we applied the function we wrote to get our results:</p>
<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1424-1"><a href="writing-for-loops.html#cb1424-1" aria-hidden="true" tabindex="-1"></a>people <span class="sc">%&gt;%</span> </span>
<span id="cb1424-2"><a href="writing-for-loops.html#cb1424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1424-3"><a href="writing-for-loops.html#cb1424-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_first_match =</span> <span class="fu">is_match</span>(name_first_1, name_first_2),</span>
<span id="cb1424-4"><a href="writing-for-loops.html#cb1424-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_last_match  =</span> <span class="fu">is_match</span>(name_last_1, name_last_2),</span>
<span id="cb1424-5"><a href="writing-for-loops.html#cb1424-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">street_match     =</span> <span class="fu">is_match</span>(street_1, street_2)</span>
<span id="cb1424-6"><a href="writing-for-loops.html#cb1424-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1424-7"><a href="writing-for-loops.html#cb1424-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Order like columns next to each other for easier comparison</span></span>
<span id="cb1424-8"><a href="writing-for-loops.html#cb1424-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id_1, <span class="fu">starts_with</span>(<span class="st">&quot;name_f&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;name_l&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;s&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##     id_1 name_first_1 name_first_2 name_first_match name_last_1 name_last_2 name_last_match street_1     street_2    street_match
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;lgl&gt;           &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;       
##  1     1 Easton       Easton       TRUE             &lt;NA&gt;        Stone       FALSE           Alameda      Alameda     TRUE        
##  2     2 Elias        Elas         FALSE            Salazar     Salazar     TRUE            Crissy Field Field       FALSE       
##  3     3 Colton       &lt;NA&gt;         FALSE            Fox         Fox         TRUE            San Bruno    &lt;NA&gt;        FALSE       
##  4     4 Cameron      Cameron      TRUE             Warren      Waren       FALSE           Nottingham   Notingham   FALSE       
##  5     5 Carson       Carsen       FALSE            Mills       Mills       TRUE            Jersey       Jersey      TRUE        
##  6     6 Addison      Adison       FALSE            Meyer       &lt;NA&gt;        FALSE           Tingley      &lt;NA&gt;        FALSE       
##  7     7 Aubrey       Aubrey       TRUE             Rice        Rice        TRUE            Buena Vista  Buena Vista TRUE        
##  8     8 Ellie        &lt;NA&gt;         FALSE            Schmidt     Schmidt     TRUE            Division     Division    TRUE        
##  9     9 Robert       Bob          FALSE            Garza       Garza       TRUE            Red Rock     Red Rock    TRUE        
## 10    10 Stella       Stella       TRUE             Daniels     &lt;NA&gt;        FALSE           Holland      Holland     TRUE</code></pre>
<p>🚩However, in the code chunk above, we still have essentially the same code copied more than twice. That’s a red flag that we should be thinking about removing unnecessary repetition from our code. Because we are using dplyr, and all of our data resides inside of a single data frame, your first instinct might be to use <code>across()</code> inside of <code>mutate()</code> to perform column-wise operations. Unfortunately, that method won’t work in this scenario.</p>
<p>The <code>across()</code> function will apply the function we pass to the <code>.fns</code> argument to each column passed to the <code>.cols</code> argument, one at a time. But, we need to pass two columns at a time to the <code>is_match()</code> function. For example, <code>name_first_1</code> and <code>name_first_2</code>. There’s really no good way to accomplish this task using <code>is_match()</code> inside of <code>across()</code>. However, it is fairly simple to accomplish this task with a for loop:</p>
<div class="sourceCode" id="cb1426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1426-1"><a href="writing-for-loops.html#cb1426-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1426-2"><a href="writing-for-loops.html#cb1426-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1426-3"><a href="writing-for-loops.html#cb1426-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1426-4"><a href="writing-for-loops.html#cb1426-4" aria-hidden="true" tabindex="-1"></a>  col_1   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1426-5"><a href="writing-for-loops.html#cb1426-5" aria-hidden="true" tabindex="-1"></a>  col_2   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1426-6"><a href="writing-for-loops.html#cb1426-6" aria-hidden="true" tabindex="-1"></a>  new_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_match&quot;</span>)</span>
<span id="cb1426-7"><a href="writing-for-loops.html#cb1426-7" aria-hidden="true" tabindex="-1"></a>  people[[new_col]] <span class="ot">&lt;-</span> <span class="fu">is_match</span>(people[[col_1]], people[[col_2]])</span>
<span id="cb1426-8"><a href="writing-for-loops.html#cb1426-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1427-1"><a href="writing-for-loops.html#cb1427-1" aria-hidden="true" tabindex="-1"></a>people <span class="sc">%&gt;%</span> </span>
<span id="cb1427-2"><a href="writing-for-loops.html#cb1427-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id_1, <span class="fu">starts_with</span>(<span class="st">&quot;name_f&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;name_l&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;s&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##     id_1 name_first_1 name_first_2 name_first_match name_last_1 name_last_2 name_last_match street_1     street_2    street_match
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;lgl&gt;           &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;       
##  1     1 Easton       Easton       TRUE             &lt;NA&gt;        Stone       FALSE           Alameda      Alameda     TRUE        
##  2     2 Elias        Elas         FALSE            Salazar     Salazar     TRUE            Crissy Field Field       FALSE       
##  3     3 Colton       &lt;NA&gt;         FALSE            Fox         Fox         TRUE            San Bruno    &lt;NA&gt;        FALSE       
##  4     4 Cameron      Cameron      TRUE             Warren      Waren       FALSE           Nottingham   Notingham   FALSE       
##  5     5 Carson       Carsen       FALSE            Mills       Mills       TRUE            Jersey       Jersey      TRUE        
##  6     6 Addison      Adison       FALSE            Meyer       &lt;NA&gt;        FALSE           Tingley      &lt;NA&gt;        FALSE       
##  7     7 Aubrey       Aubrey       TRUE             Rice        Rice        TRUE            Buena Vista  Buena Vista TRUE        
##  8     8 Ellie        &lt;NA&gt;         FALSE            Schmidt     Schmidt     TRUE            Division     Division    TRUE        
##  9     9 Robert       Bob          FALSE            Garza       Garza       TRUE            Red Rock     Red Rock    TRUE        
## 10    10 Stella       Stella       TRUE             Daniels     &lt;NA&gt;        FALSE           Holland      Holland     TRUE</code></pre>
<p>👆<strong>Here’s what we did above:</strong></p>
<ul>
<li>We used our <code>is_match()</code> function inside of a for loop to create three new dummy variables that indicated whether first name, last name, and address matched respectively.</li>
</ul>
<p>Let’s pull the code apart piece-by-piece to see how it works.</p>
<div class="sourceCode" id="cb1429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1429-1"><a href="writing-for-loops.html#cb1429-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1429-2"><a href="writing-for-loops.html#cb1429-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1429-3"><a href="writing-for-loops.html#cb1429-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1429-4"><a href="writing-for-loops.html#cb1429-4" aria-hidden="true" tabindex="-1"></a>  col_1   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1429-5"><a href="writing-for-loops.html#cb1429-5" aria-hidden="true" tabindex="-1"></a>  col_2   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1429-6"><a href="writing-for-loops.html#cb1429-6" aria-hidden="true" tabindex="-1"></a>  new_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_match&quot;</span>)</span>
<span id="cb1429-7"><a href="writing-for-loops.html#cb1429-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(col_1)</span>
<span id="cb1429-8"><a href="writing-for-loops.html#cb1429-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(col_2)</span>
<span id="cb1429-9"><a href="writing-for-loops.html#cb1429-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(new_col)</span>
<span id="cb1429-10"><a href="writing-for-loops.html#cb1429-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;name_first_1&quot;
## [1] &quot;name_first_2&quot;
## [1] &quot;name_first_match&quot;
## [1] &quot;name_last_1&quot;
## [1] &quot;name_last_2&quot;
## [1] &quot;name_last_match&quot;
## [1] &quot;street_1&quot;
## [1] &quot;street_2&quot;
## [1] &quot;street_match&quot;</code></pre>
<p>First, we created a character vector that contained the base name (i.e., no <code>_1</code> or <code>_2</code>) of each of the columns we wanted to compare. Then, we iterated over that character vector by passing it as the object to the right of the keyword <code>in</code>.</p>
<p>At each iteration, we used <code>paste0()</code> to create three column names from the character string in <code>cols</code>. For example, in the first iteration of the loop, the value of <code>cols</code> was <code>name_first</code>. The first line of code in the for loop body combined <code>name_first</code> with <code>_1</code> to make the character string <code>name_first_1</code> and save it as an object named <code>col_1</code>. The second line of code in the for loop body combined <code>name_first</code> with <code>_2</code> to make the character string <code>name_first_2</code> and save it as an object named <code>col_2</code>. And, the third line of code in the for loop body combined <code>name_first</code> with <code>_match</code> to make the character string <code>name_first_match</code> and save it as an object named <code>new_col</code>.</p>
<p>This will allow us to use <code>col_1</code>, <code>col_2</code>, and <code>new_col</code> in the code that compares the columns and creates each dummy variable. For example, here is what <code>people[[col_1]]</code> looks like at each iteration:</p>
<div class="sourceCode" id="cb1431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1431-1"><a href="writing-for-loops.html#cb1431-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1431-2"><a href="writing-for-loops.html#cb1431-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1431-3"><a href="writing-for-loops.html#cb1431-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1431-4"><a href="writing-for-loops.html#cb1431-4" aria-hidden="true" tabindex="-1"></a>  col_1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1431-5"><a href="writing-for-loops.html#cb1431-5" aria-hidden="true" tabindex="-1"></a>  col_2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1431-6"><a href="writing-for-loops.html#cb1431-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(people[[col_1]])</span>
<span id="cb1431-7"><a href="writing-for-loops.html#cb1431-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>##  [1] &quot;Easton&quot;  &quot;Elias&quot;   &quot;Colton&quot;  &quot;Cameron&quot; &quot;Carson&quot;  &quot;Addison&quot; &quot;Aubrey&quot;  &quot;Ellie&quot;   &quot;Robert&quot;  &quot;Stella&quot; 
##  [1] NA        &quot;Salazar&quot; &quot;Fox&quot;     &quot;Warren&quot;  &quot;Mills&quot;   &quot;Meyer&quot;   &quot;Rice&quot;    &quot;Schmidt&quot; &quot;Garza&quot;   &quot;Daniels&quot;
##  [1] &quot;Alameda&quot;      &quot;Crissy Field&quot; &quot;San Bruno&quot;    &quot;Nottingham&quot;   &quot;Jersey&quot;       &quot;Tingley&quot;      &quot;Buena Vista&quot;  &quot;Division&quot;    
##  [9] &quot;Red Rock&quot;     &quot;Holland&quot;</code></pre>
<p>It is a vector that matches <code>people[["name_first_1"]]</code>, <code>people[["name_last_1"]]</code>, and <code>people[["street_1"]]</code> respectively.</p>
<p>And here is what <code>col_2</code> looks like at each iteration:</p>
<div class="sourceCode" id="cb1433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1433-1"><a href="writing-for-loops.html#cb1433-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1433-2"><a href="writing-for-loops.html#cb1433-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1433-3"><a href="writing-for-loops.html#cb1433-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1433-4"><a href="writing-for-loops.html#cb1433-4" aria-hidden="true" tabindex="-1"></a>  col_1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1433-5"><a href="writing-for-loops.html#cb1433-5" aria-hidden="true" tabindex="-1"></a>  col_2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1433-6"><a href="writing-for-loops.html#cb1433-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(people[[col_2]])</span>
<span id="cb1433-7"><a href="writing-for-loops.html#cb1433-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>##  [1] &quot;Easton&quot;  &quot;Elas&quot;    NA        &quot;Cameron&quot; &quot;Carsen&quot;  &quot;Adison&quot;  &quot;Aubrey&quot;  NA        &quot;Bob&quot;     &quot;Stella&quot; 
##  [1] &quot;Stone&quot;   &quot;Salazar&quot; &quot;Fox&quot;     &quot;Waren&quot;   &quot;Mills&quot;   NA        &quot;Rice&quot;    &quot;Schmidt&quot; &quot;Garza&quot;   NA       
##  [1] &quot;Alameda&quot;     &quot;Field&quot;       NA            &quot;Notingham&quot;   &quot;Jersey&quot;      NA            &quot;Buena Vista&quot; &quot;Division&quot;    &quot;Red Rock&quot;   
## [10] &quot;Holland&quot;</code></pre>
<p>Now, we can pass each vector to our <code>is_match()</code> function at each iteration like this:</p>
<div class="sourceCode" id="cb1435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1435-1"><a href="writing-for-loops.html#cb1435-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1435-2"><a href="writing-for-loops.html#cb1435-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1435-3"><a href="writing-for-loops.html#cb1435-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1435-4"><a href="writing-for-loops.html#cb1435-4" aria-hidden="true" tabindex="-1"></a>  col_1 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1435-5"><a href="writing-for-loops.html#cb1435-5" aria-hidden="true" tabindex="-1"></a>  col_2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1435-6"><a href="writing-for-loops.html#cb1435-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">is_match</span>(people[[col_1]], people[[col_2]]))</span>
<span id="cb1435-7"><a href="writing-for-loops.html#cb1435-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>##  [1]  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE
##  [1] FALSE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE
##  [1]  TRUE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>These logical vectors are the results we want to go into our new dummy variables. Therefore, the last step is to assign each logical vector above to a new variable in our data frame called <code>people[["name_first_match"]]</code>, <code>people[["name_last_match"]]</code>, and <code>people[["street_match"]]</code> respectively. We do so by allowing <code>people[[new_col]]</code> to represent those values at each iteration of the loop:</p>
<div class="sourceCode" id="cb1437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1437-1"><a href="writing-for-loops.html#cb1437-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;name_last&quot;</span>, <span class="st">&quot;street&quot;</span>)</span>
<span id="cb1437-2"><a href="writing-for-loops.html#cb1437-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1437-3"><a href="writing-for-loops.html#cb1437-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(cols)) {</span>
<span id="cb1437-4"><a href="writing-for-loops.html#cb1437-4" aria-hidden="true" tabindex="-1"></a>  col_1   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_1&quot;</span>)</span>
<span id="cb1437-5"><a href="writing-for-loops.html#cb1437-5" aria-hidden="true" tabindex="-1"></a>  col_2   <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_2&quot;</span>)</span>
<span id="cb1437-6"><a href="writing-for-loops.html#cb1437-6" aria-hidden="true" tabindex="-1"></a>  new_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(cols[[i]], <span class="st">&quot;_match&quot;</span>)</span>
<span id="cb1437-7"><a href="writing-for-loops.html#cb1437-7" aria-hidden="true" tabindex="-1"></a>  people[[new_col]] <span class="ot">&lt;-</span> <span class="fu">is_match</span>(people[[col_1]], people[[col_2]])</span>
<span id="cb1437-8"><a href="writing-for-loops.html#cb1437-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is our result:</p>
<div class="sourceCode" id="cb1438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1438-1"><a href="writing-for-loops.html#cb1438-1" aria-hidden="true" tabindex="-1"></a>people <span class="sc">%&gt;%</span> </span>
<span id="cb1438-2"><a href="writing-for-loops.html#cb1438-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id_1, <span class="fu">starts_with</span>(<span class="st">&quot;name_f&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;name_l&quot;</span>), <span class="fu">starts_with</span>(<span class="st">&quot;s&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##     id_1 name_first_1 name_first_2 name_first_match name_last_1 name_last_2 name_last_match street_1     street_2    street_match
##    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;lgl&gt;            &lt;chr&gt;       &lt;chr&gt;       &lt;lgl&gt;           &lt;chr&gt;        &lt;chr&gt;       &lt;lgl&gt;       
##  1     1 Easton       Easton       TRUE             &lt;NA&gt;        Stone       FALSE           Alameda      Alameda     TRUE        
##  2     2 Elias        Elas         FALSE            Salazar     Salazar     TRUE            Crissy Field Field       FALSE       
##  3     3 Colton       &lt;NA&gt;         FALSE            Fox         Fox         TRUE            San Bruno    &lt;NA&gt;        FALSE       
##  4     4 Cameron      Cameron      TRUE             Warren      Waren       FALSE           Nottingham   Notingham   FALSE       
##  5     5 Carson       Carsen       FALSE            Mills       Mills       TRUE            Jersey       Jersey      TRUE        
##  6     6 Addison      Adison       FALSE            Meyer       &lt;NA&gt;        FALSE           Tingley      &lt;NA&gt;        FALSE       
##  7     7 Aubrey       Aubrey       TRUE             Rice        Rice        TRUE            Buena Vista  Buena Vista TRUE        
##  8     8 Ellie        &lt;NA&gt;         FALSE            Schmidt     Schmidt     TRUE            Division     Division    TRUE        
##  9     9 Robert       Bob          FALSE            Garza       Garza       TRUE            Red Rock     Red Rock    TRUE        
## 10    10 Stella       Stella       TRUE             Daniels     &lt;NA&gt;        FALSE           Holland      Holland     TRUE</code></pre>
<p>In the code above, we used roughly the same amount of code to complete the task with a loop that we used to complete it without a loop. However, this code still has some advantages. We only typed “name_first,” “name_last,” and “street” once at the beginning of the code chunk. Therefore, we didn’t have to worry about forgetting to change a column name after copying and pasting code. Additionally, if we later decide that we also want to compare other columns (e.g., middle name, birth date, city, state, zip code), we only have to update the code in one place – where we create the <code>cols</code> vector.</p>
</div>
<div id="using-for-loops-for-analysis" class="section level2" number="35.4">
<h2><span class="header-section-number">35.4</span> Using for loops for analysis</h2>
<p>For our final example of this chapter, let’s return to the final example from the <a href="column-wise-operations-in-dplyr.html#across-with-summarise">column-wise operations chapter</a>. We started with some simulated study data:</p>
<div class="sourceCode" id="cb1440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1440-1"><a href="writing-for-loops.html#cb1440-1" aria-hidden="true" tabindex="-1"></a>study <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1440-2"><a href="writing-for-loops.html#cb1440-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">age       =</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">32</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">38</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">48</span>, <span class="dv">29</span>, <span class="dv">22</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">24</span>, <span class="dv">25</span>, </span>
<span id="cb1440-3"><a href="writing-for-loops.html#cb1440-3" aria-hidden="true" tabindex="-1"></a>                <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">23</span>, </span>
<span id="cb1440-4"><a href="writing-for-loops.html#cb1440-4" aria-hidden="true" tabindex="-1"></a>                <span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">43</span>, <span class="dv">25</span>, <span class="dv">24</span>, </span>
<span id="cb1440-5"><a href="writing-for-loops.html#cb1440-5" aria-hidden="true" tabindex="-1"></a>                <span class="dv">27</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">31</span>, <span class="dv">34</span>, </span>
<span id="cb1440-6"><a href="writing-for-loops.html#cb1440-6" aria-hidden="true" tabindex="-1"></a>                <span class="dv">26</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="cn">NA</span>),</span>
<span id="cb1440-7"><a href="writing-for-loops.html#cb1440-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1440-8"><a href="writing-for-loops.html#cb1440-8" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1440-9"><a href="writing-for-loops.html#cb1440-9" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, </span>
<span id="cb1440-10"><a href="writing-for-loops.html#cb1440-10" aria-hidden="true" tabindex="-1"></a>                <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>),</span>
<span id="cb1440-11"><a href="writing-for-loops.html#cb1440-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1440-12"><a href="writing-for-loops.html#cb1440-12" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb1440-13"><a href="writing-for-loops.html#cb1440-13" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb1440-14"><a href="writing-for-loops.html#cb1440-14" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="cn">NA</span>),</span>
<span id="cb1440-15"><a href="writing-for-loops.html#cb1440-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ht_in     =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">62</span>, <span class="dv">67</span>, <span class="dv">67</span>, <span class="dv">58</span>, <span class="dv">64</span>, <span class="dv">69</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">65</span>, </span>
<span id="cb1440-16"><a href="writing-for-loops.html#cb1440-16" aria-hidden="true" tabindex="-1"></a>                <span class="dv">64</span>, <span class="dv">75</span>, <span class="dv">67</span>, <span class="dv">63</span>, <span class="dv">60</span>, <span class="dv">67</span>, <span class="dv">64</span>, <span class="dv">73</span>, <span class="dv">62</span>, <span class="dv">69</span>, <span class="dv">67</span>, <span class="dv">62</span>, <span class="dv">68</span>, <span class="dv">66</span>, <span class="dv">66</span>, <span class="dv">62</span>, </span>
<span id="cb1440-17"><a href="writing-for-loops.html#cb1440-17" aria-hidden="true" tabindex="-1"></a>                <span class="dv">64</span>, <span class="dv">68</span>, <span class="cn">NA</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">68</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">63</span>, <span class="dv">67</span>, <span class="dv">66</span>, </span>
<span id="cb1440-18"><a href="writing-for-loops.html#cb1440-18" aria-hidden="true" tabindex="-1"></a>                <span class="dv">69</span>, <span class="dv">76</span>, <span class="cn">NA</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">66</span>, <span class="dv">65</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">64</span>, <span class="dv">71</span>, <span class="dv">60</span>, <span class="dv">62</span>, </span>
<span id="cb1440-19"><a href="writing-for-loops.html#cb1440-19" aria-hidden="true" tabindex="-1"></a>                <span class="dv">61</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="cn">NA</span>),</span>
<span id="cb1440-20"><a href="writing-for-loops.html#cb1440-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">wt_lbs    =</span> <span class="fu">c</span>(<span class="dv">216</span>, <span class="dv">106</span>, <span class="dv">145</span>, <span class="dv">195</span>, <span class="dv">143</span>, <span class="dv">125</span>, <span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">158</span>, <span class="dv">167</span>, <span class="dv">145</span>, <span class="dv">297</span>, <span class="dv">146</span>, </span>
<span id="cb1440-21"><a href="writing-for-loops.html#cb1440-21" aria-hidden="true" tabindex="-1"></a>                <span class="dv">125</span>, <span class="dv">111</span>, <span class="dv">125</span>, <span class="dv">130</span>, <span class="dv">182</span>, <span class="dv">170</span>, <span class="dv">121</span>, <span class="dv">98</span>, <span class="dv">150</span>, <span class="dv">132</span>, <span class="dv">250</span>, <span class="dv">137</span>, <span class="dv">124</span>, </span>
<span id="cb1440-22"><a href="writing-for-loops.html#cb1440-22" aria-hidden="true" tabindex="-1"></a>                <span class="dv">186</span>, <span class="dv">148</span>, <span class="dv">134</span>, <span class="dv">155</span>, <span class="dv">122</span>, <span class="dv">142</span>, <span class="dv">110</span>, <span class="dv">132</span>, <span class="dv">188</span>, <span class="dv">176</span>, <span class="dv">188</span>, <span class="dv">166</span>, <span class="dv">136</span>, </span>
<span id="cb1440-23"><a href="writing-for-loops.html#cb1440-23" aria-hidden="true" tabindex="-1"></a>                <span class="dv">147</span>, <span class="dv">178</span>, <span class="dv">125</span>, <span class="dv">102</span>, <span class="dv">140</span>, <span class="dv">139</span>, <span class="dv">60</span>, <span class="dv">147</span>, <span class="dv">147</span>, <span class="dv">141</span>, <span class="dv">232</span>, <span class="dv">186</span>, <span class="dv">212</span>, </span>
<span id="cb1440-24"><a href="writing-for-loops.html#cb1440-24" aria-hidden="true" tabindex="-1"></a>                <span class="dv">110</span>, <span class="dv">110</span>, <span class="dv">115</span>, <span class="dv">154</span>, <span class="dv">140</span>, <span class="dv">150</span>, <span class="dv">130</span>, <span class="cn">NA</span>, <span class="dv">171</span>, <span class="dv">156</span>, <span class="dv">92</span>, <span class="dv">122</span>, <span class="dv">102</span>, </span>
<span id="cb1440-25"><a href="writing-for-loops.html#cb1440-25" aria-hidden="true" tabindex="-1"></a>                <span class="dv">163</span>, <span class="dv">141</span>, <span class="cn">NA</span>),</span>
<span id="cb1440-26"><a href="writing-for-loops.html#cb1440-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">bmi       =</span> <span class="fu">c</span>(<span class="fl">30.99</span>, <span class="fl">18.78</span>, <span class="fl">26.52</span>, <span class="fl">30.54</span>, <span class="fl">22.39</span>, <span class="fl">26.12</span>, <span class="fl">23.69</span>, <span class="fl">20.67</span>, <span class="fl">26.29</span>, </span>
<span id="cb1440-27"><a href="writing-for-loops.html#cb1440-27" aria-hidden="true" tabindex="-1"></a>                <span class="fl">25.39</span>, <span class="fl">25.68</span>, <span class="fl">45.15</span>, <span class="fl">21.56</span>, <span class="fl">20.17</span>, <span class="fl">17.38</span>, <span class="fl">20.8</span>, <span class="fl">22.31</span>, <span class="fl">22.75</span>, </span>
<span id="cb1440-28"><a href="writing-for-loops.html#cb1440-28" aria-hidden="true" tabindex="-1"></a>                <span class="fl">26.62</span>, <span class="fl">21.43</span>, <span class="fl">19.14</span>, <span class="fl">23.49</span>, <span class="fl">22.66</span>, <span class="fl">32.98</span>, <span class="fl">25.05</span>, <span class="fl">18.31</span>, <span class="fl">29.13</span>, </span>
<span id="cb1440-29"><a href="writing-for-loops.html#cb1440-29" aria-hidden="true" tabindex="-1"></a>                <span class="fl">27.07</span>, <span class="fl">20.37</span>, <span class="fl">25.01</span>, <span class="fl">19.69</span>, <span class="fl">25.97</span>, <span class="fl">18.88</span>, <span class="fl">20.07</span>, <span class="cn">NA</span>, <span class="fl">26.76</span>, </span>
<span id="cb1440-30"><a href="writing-for-loops.html#cb1440-30" aria-hidden="true" tabindex="-1"></a>                <span class="fl">26.97</span>, <span class="fl">25.24</span>, <span class="fl">20.68</span>, <span class="fl">23.72</span>, <span class="fl">24.82</span>, <span class="fl">23.62</span>, <span class="fl">18.65</span>, <span class="fl">24.03</span>, <span class="fl">23.86</span>, </span>
<span id="cb1440-31"><a href="writing-for-loops.html#cb1440-31" aria-hidden="true" tabindex="-1"></a>                <span class="fl">10.63</span>, <span class="fl">23.02</span>, <span class="fl">23.72</span>, <span class="fl">20.82</span>, <span class="fl">28.24</span>, <span class="cn">NA</span>, <span class="fl">37.55</span>, <span class="fl">18.88</span>, <span class="fl">18.3</span>, </span>
<span id="cb1440-32"><a href="writing-for-loops.html#cb1440-32" aria-hidden="true" tabindex="-1"></a>                <span class="fl">19.13</span>, <span class="fl">21.48</span>, <span class="fl">22.59</span>, <span class="fl">24.96</span>, <span class="fl">21.63</span>, <span class="cn">NA</span>, <span class="fl">29.35</span>, <span class="fl">21.76</span>, <span class="fl">17.97</span>, </span>
<span id="cb1440-33"><a href="writing-for-loops.html#cb1440-33" aria-hidden="true" tabindex="-1"></a>                <span class="fl">22.31</span>, <span class="fl">19.27</span>, <span class="fl">24.07</span>, <span class="fl">22.76</span>, <span class="cn">NA</span>),</span>
<span id="cb1440-34"><a href="writing-for-loops.html#cb1440-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">bmi_3cat  =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1440-35"><a href="writing-for-loops.html#cb1440-35" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb1440-36"><a href="writing-for-loops.html#cb1440-36" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb1440-37"><a href="writing-for-loops.html#cb1440-37" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb1440-38"><a href="writing-for-loops.html#cb1440-38" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb1440-39"><a href="writing-for-loops.html#cb1440-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1440-40"><a href="writing-for-loops.html#cb1440-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">factor</span>(age_group, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Younger than 30&quot;</span>, <span class="st">&quot;30 and Older&quot;</span>)),</span>
<span id="cb1440-41"><a href="writing-for-loops.html#cb1440-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender    =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)),</span>
<span id="cb1440-42"><a href="writing-for-loops.html#cb1440-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_3cat  =</span> <span class="fu">factor</span>(bmi_3cat, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Normal&quot;</span>, <span class="st">&quot;Overweight&quot;</span>, <span class="st">&quot;Obese&quot;</span>))</span>
<span id="cb1440-43"><a href="writing-for-loops.html#cb1440-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1440-44"><a href="writing-for-loops.html#cb1440-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 68 × 7
##      age age_group       gender ht_in wt_lbs   bmi bmi_3cat  
##    &lt;dbl&gt; &lt;fct&gt;           &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     
##  1    32 30 and Older    Male      70    216  31.0 Obese     
##  2    30 30 and Older    Female    63    106  18.8 Normal    
##  3    32 30 and Older    Female    62    145  26.5 Overweight
##  4    29 Younger than 30 Male      67    195  30.5 Obese     
##  5    24 Younger than 30 Female    67    143  22.4 Normal    
##  6    38 30 and Older    Female    58    125  26.1 Overweight
##  7    25 Younger than 30 Female    64    138  23.7 Normal    
##  8    24 Younger than 30 Male      69    140  20.7 Normal    
##  9    48 30 and Older    Male      65    158  26.3 Overweight
## 10    29 Younger than 30 Male      68    167  25.4 Overweight
## # … with 58 more rows</code></pre>
<p>Then we saw how to use <code>across()</code> with <code>pivot_longer()</code> to remove repetition and get our results into a format that were easier to read an interpret:</p>
<div class="sourceCode" id="cb1442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1442-1"><a href="writing-for-loops.html#cb1442-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1442-2"><a href="writing-for-loops.html#cb1442-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1442-3"><a href="writing-for-loops.html#cb1442-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb1442-4"><a href="writing-for-loops.html#cb1442-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols  =</span> <span class="fu">c</span>(age, ht_in, wt_lbs, bmi),</span>
<span id="cb1442-5"><a href="writing-for-loops.html#cb1442-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns   =</span> <span class="fu">list</span>(</span>
<span id="cb1442-6"><a href="writing-for-loops.html#cb1442-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_miss =</span> <span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.x)),</span>
<span id="cb1442-7"><a href="writing-for-loops.html#cb1442-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean   =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1442-8"><a href="writing-for-loops.html#cb1442-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span> <span class="fu">median</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1442-9"><a href="writing-for-loops.html#cb1442-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">min    =</span> <span class="sc">~</span> <span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1442-10"><a href="writing-for-loops.html#cb1442-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">max    =</span> <span class="sc">~</span> <span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1442-11"><a href="writing-for-loops.html#cb1442-11" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb1442-12"><a href="writing-for-loops.html#cb1442-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">.names =</span> <span class="st">&quot;{col}-{fn}&quot;</span> <span class="co"># This is the new part of the code</span></span>
<span id="cb1442-13"><a href="writing-for-loops.html#cb1442-13" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb1442-14"><a href="writing-for-loops.html#cb1442-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1442-15"><a href="writing-for-loops.html#cb1442-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 20
##   `age-n_miss` `age-mean` `age-median` `age-min` `age-max` `ht_in-n_miss` `ht_in-mean` `ht_in-median` `ht_in-min` `ht_in-max`
##          &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;          &lt;int&gt;        &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
## 1            1       26.9           26        22        48              3         66.0             66          58          76
## # … with 10 more variables: wt_lbs-n_miss &lt;int&gt;, wt_lbs-mean &lt;dbl&gt;, wt_lbs-median &lt;dbl&gt;, wt_lbs-min &lt;dbl&gt;, wt_lbs-max &lt;dbl&gt;,
## #   bmi-n_miss &lt;int&gt;, bmi-mean &lt;dbl&gt;, bmi-median &lt;dbl&gt;, bmi-min &lt;dbl&gt;, bmi-max &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb1444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1444-1"><a href="writing-for-loops.html#cb1444-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="sc">%&gt;%</span> </span>
<span id="cb1444-2"><a href="writing-for-loops.html#cb1444-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb1444-3"><a href="writing-for-loops.html#cb1444-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="fu">everything</span>(),</span>
<span id="cb1444-4"><a href="writing-for-loops.html#cb1444-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="fu">c</span>(<span class="st">&quot;characteristic&quot;</span>, <span class="st">&quot;.value&quot;</span>),</span>
<span id="cb1444-5"><a href="writing-for-loops.html#cb1444-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">&quot;-&quot;</span></span>
<span id="cb1444-6"><a href="writing-for-loops.html#cb1444-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 4 × 6
##   characteristic n_miss  mean median   min   max
##   &lt;chr&gt;           &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 age                 1  26.9   26    22    48  
## 2 ht_in               3  66.0   66    58    76  
## 3 wt_lbs              2 148.   142.   60   297  
## 4 bmi                 4  23.6   22.9  10.6  45.2</code></pre>
<p>I think that method works really nicely for our continuous variables; however, the situation is slightly more complicated for categorical variables. To illustrate the problem as simply as possible, let’s start by just getting counts for each of our categorical variables:</p>
<div class="sourceCode" id="cb1446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1446-1"><a href="writing-for-loops.html#cb1446-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1446-2"><a href="writing-for-loops.html#cb1446-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   age_group           n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Younger than 30    56
## 2 30 and Older       11
## 3 &lt;NA&gt;                1</code></pre>
<div class="sourceCode" id="cb1448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1448-1"><a href="writing-for-loops.html#cb1448-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1448-2"><a href="writing-for-loops.html#cb1448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   gender     n
##   &lt;fct&gt;  &lt;int&gt;
## 1 Female    43
## 2 Male      24
## 3 &lt;NA&gt;       1</code></pre>
<div class="sourceCode" id="cb1450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1450-1"><a href="writing-for-loops.html#cb1450-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1450-2"><a href="writing-for-loops.html#cb1450-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bmi_3cat)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   bmi_3cat       n
##   &lt;fct&gt;      &lt;int&gt;
## 1 Normal        43
## 2 Overweight    16
## 3 Obese          5
## 4 &lt;NA&gt;           4</code></pre>
<p>You are, of course, and old pro at this by now, and you quickly spot all the unnecessary repetition. So, you decide to pass <code>count</code> to the <code>.fns</code> argument like this:</p>
<div class="sourceCode" id="cb1452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1452-1"><a href="writing-for-loops.html#cb1452-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1452-2"><a href="writing-for-loops.html#cb1452-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1452-3"><a href="writing-for-loops.html#cb1452-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb1452-4"><a href="writing-for-loops.html#cb1452-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(age_group, gender, bmi_3cat),</span>
<span id="cb1452-5"><a href="writing-for-loops.html#cb1452-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns  =</span> count</span>
<span id="cb1452-6"><a href="writing-for-loops.html#cb1452-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1452-7"><a href="writing-for-loops.html#cb1452-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Error: Problem with `summarise()` input `..1`.
## ℹ `..1 = across(.cols = c(age_group, gender, bmi_3cat), .fns = count)`.
## x no applicable method for &#39;count&#39; applied to an object of class &quot;factor&quot;</code></pre>
<p>Unfortunately, this won’t work. At least not currently. There are a couple reasons why this won’t work, but the one that is probably easiest to wrap your head around is related to the number of results produced by <code>count()</code>. What do I mean by that? Well, when we pass each continuous variable to <code>mean()</code> (or <code>median</code>, <code>min</code>, or <code>max</code>) we get <em>one</em> result back for each column:</p>
<div class="sourceCode" id="cb1454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1454-1"><a href="writing-for-loops.html#cb1454-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1454-2"><a href="writing-for-loops.html#cb1454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1454-3"><a href="writing-for-loops.html#cb1454-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb1454-4"><a href="writing-for-loops.html#cb1454-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(age, ht_in),</span>
<span id="cb1454-5"><a href="writing-for-loops.html#cb1454-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns  =</span> <span class="sc">~</span> <span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1454-6"><a href="writing-for-loops.html#cb1454-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1454-7"><a href="writing-for-loops.html#cb1454-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##     age ht_in
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  26.9  66.0</code></pre>
<p>It’s easy for <code>dplyr</code> to arrange those results into a data frame. However, the results from <code>count()</code> are much less predictable. For example, <code>study %&gt;% count(age_group)</code> had three results, <code>study %&gt;% count(gender)</code> had three results, and <code>study %&gt;% count(bmi_3cat)</code> had four results. Also, remember that every column of a data frame has to have the same number of rows. So, if the code we used to try to pass <code>count</code> to the <code>.fns</code> argument above would actually run, it might look something like this:</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/summarise.png" width="900" /></p>
<p>Because <code>summarise()</code> lays the results out side-by-side, it’s not clear what would go into the 4 cells in the bottom-left corner of the results data frame. Therefore, it isn’t necessarily straightforward for <code>dplyr</code> to figure out how it should return such results to us.</p>
<p>However, when we use a for loop, <em>we can create our own structure</em> to hold the results. And, that structure can be pretty much any structure that meets our needs. In this case, one option would be to create a data frame to hold our categorical counts that looks like this:</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/our_structure_1.png" width="900" /></p>
<p>Then, we can use a for loop to fill in the empty data frame so that we end up with results that look like this:</p>
<p><img src="img/07_part_repeated_operations/04_for_loops/our_structure_2.png" width="900" /></p>
<p>The process for getting to our finished product is a little bit involved (and probably a little intimidating for some of you) and will require us to cover a couple new topics. So, I’m going to start by giving you the complete code for accomplishing this task. Then, we’ll pick the code apart, piece-by-piece, to make sure we understand <em>how</em> it works.</p>
<p>Here is the complete solution:</p>
<div class="sourceCode" id="cb1456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1456-1"><a href="writing-for-loops.html#cb1456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure 1. An object to contain the results.</span></span>
<span id="cb1456-2"><a href="writing-for-loops.html#cb1456-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the data frame structure that will contain our results</span></span>
<span id="cb1456-3"><a href="writing-for-loops.html#cb1456-3" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1456-4"><a href="writing-for-loops.html#cb1456-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1456-5"><a href="writing-for-loops.html#cb1456-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1456-6"><a href="writing-for-loops.html#cb1456-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n        =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb1456-7"><a href="writing-for-loops.html#cb1456-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb1456-8"><a href="writing-for-loops.html#cb1456-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1456-9"><a href="writing-for-loops.html#cb1456-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure 2. The actual for loop.</span></span>
<span id="cb1456-10"><a href="writing-for-loops.html#cb1456-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For each column, get the column name, category names, and count.</span></span>
<span id="cb1456-11"><a href="writing-for-loops.html#cb1456-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then, add them to the bottom of the results data frame we created above.</span></span>
<span id="cb1456-12"><a href="writing-for-loops.html#cb1456-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1456-13"><a href="writing-for-loops.html#cb1456-13" aria-hidden="true" tabindex="-1"></a>  cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1456-14"><a href="writing-for-loops.html#cb1456-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span> <span class="co"># Use .data to refer to the current data frame.</span></span>
<span id="cb1456-15"><a href="writing-for-loops.html#cb1456-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="co"># Use . to refer to the result to this point.</span></span>
<span id="cb1456-16"><a href="writing-for-loops.html#cb1456-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1456-17"><a href="writing-for-loops.html#cb1456-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1456-18"><a href="writing-for-loops.html#cb1456-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here is where we update cat_table with the results for each column</span></span>
<span id="cb1456-19"><a href="writing-for-loops.html#cb1456-19" aria-hidden="true" tabindex="-1"></a>  cat_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cat_table, cat_stats)</span>
<span id="cb1456-20"><a href="writing-for-loops.html#cb1456-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1457-1"><a href="writing-for-loops.html#cb1457-1" aria-hidden="true" tabindex="-1"></a>cat_table</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>We’ll use the rest of this chapter section to walk through the code above and make sure we understand how it works. For starters, we will create our results data frame structure like this:</p>
<div class="sourceCode" id="cb1459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1459-1"><a href="writing-for-loops.html#cb1459-1" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1459-2"><a href="writing-for-loops.html#cb1459-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1459-3"><a href="writing-for-loops.html#cb1459-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1459-4"><a href="writing-for-loops.html#cb1459-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n        =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb1459-5"><a href="writing-for-loops.html#cb1459-5" aria-hidden="true" tabindex="-1"></a>) </span></code></pre></div>
<div class="sourceCode" id="cb1460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1460-1"><a href="writing-for-loops.html#cb1460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cat_table)</span></code></pre></div>
<pre><code>## tibble [0 × 3] (S3: tbl_df/tbl/data.frame)
##  $ variable: chr(0) 
##  $ category: chr(0) 
##  $ n       : num(0)</code></pre>
<p>As you can see, we created an empty data frame with three columns. One to hold the variable names, one to hold the variable categories, and one to hold the count of occurrences of each category. Now, we can use a for loop to iteratively add results to our empty data frame structure. This works similarly to the way we added mean values to the <code>xyz_means</code> vector in the first example above. As a reminder, here is what the for loop code looks like:</p>
<div class="sourceCode" id="cb1462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1462-1"><a href="writing-for-loops.html#cb1462-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1462-2"><a href="writing-for-loops.html#cb1462-2" aria-hidden="true" tabindex="-1"></a>  cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1462-3"><a href="writing-for-loops.html#cb1462-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span></span>
<span id="cb1462-4"><a href="writing-for-loops.html#cb1462-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb1462-5"><a href="writing-for-loops.html#cb1462-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1462-6"><a href="writing-for-loops.html#cb1462-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1462-7"><a href="writing-for-loops.html#cb1462-7" aria-hidden="true" tabindex="-1"></a>  cat_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cat_table, cat_stats)</span>
<span id="cb1462-8"><a href="writing-for-loops.html#cb1462-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>For our next step, let’s walk through the first little chunk of code inside the for loop body. Specifically:</p>
<div class="sourceCode" id="cb1463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1463-1"><a href="writing-for-loops.html#cb1463-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1463-2"><a href="writing-for-loops.html#cb1463-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span></span>
<span id="cb1463-3"><a href="writing-for-loops.html#cb1463-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb1463-4"><a href="writing-for-loops.html#cb1463-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>If we were using this code to analyze a single variable, as opposed to using it in a for loop, this is what the result would look like:</p>
<div class="sourceCode" id="cb1464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1464-1"><a href="writing-for-loops.html#cb1464-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1464-2"><a href="writing-for-loops.html#cb1464-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb1464-3"><a href="writing-for-loops.html#cb1464-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb1464-4"><a href="writing-for-loops.html#cb1464-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1464-5"><a href="writing-for-loops.html#cb1464-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   category            n variable 
##   &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;    
## 1 Younger than 30    56 age_group
## 2 30 and Older       11 age_group
## 3 &lt;NA&gt;                1 age_group</code></pre>
<p>We’ve already seen what the <code>study %&gt;% count(age_group)</code> part of the code does, and we already know that we can use <code>mutate()</code> to create a new column in our data frame. In this case, the name of the new column is <code>variable</code>. But, you may be wondering what the <code>names(.)[1]</code> after the equal sign does. Let’s take a look. Here, we can see the data frame that is getting passed to <code>mutate()</code>:</p>
<div class="sourceCode" id="cb1466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1466-1"><a href="writing-for-loops.html#cb1466-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1466-2"><a href="writing-for-loops.html#cb1466-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb1466-3"><a href="writing-for-loops.html#cb1466-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   age_group           n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Younger than 30    56
## 2 30 and Older       11
## 3 &lt;NA&gt;                1</code></pre>
<p>It’s a data frame with two columns. The first column actually has two different kinds of information that we need. It contains the name of the variable being analyzed as the column name, and it contains all the categories of that variable as the column values. We want to separate those two pieces of information into two columns. This task is similar to some of the “tidy data” tasks we worked through in the <a href="restructuring-data-frames.html#tidy-data">chapter on restructuring data frames</a>. In fact, we can also use <code>pivot_longer()</code> to get the result we want:</p>
<div class="sourceCode" id="cb1468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1468-1"><a href="writing-for-loops.html#cb1468-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1468-2"><a href="writing-for-loops.html#cb1468-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb1468-3"><a href="writing-for-loops.html#cb1468-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb1468-4"><a href="writing-for-loops.html#cb1468-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="st">&quot;age_group&quot;</span>,</span>
<span id="cb1468-5"><a href="writing-for-loops.html#cb1468-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb1468-6"><a href="writing-for-loops.html#cb1468-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;category&quot;</span></span>
<span id="cb1468-7"><a href="writing-for-loops.html#cb1468-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##       n variable  category       
##   &lt;int&gt; &lt;chr&gt;     &lt;fct&gt;          
## 1    56 age_group Younger than 30
## 2    11 age_group 30 and Older   
## 3     1 age_group &lt;NA&gt;</code></pre>
<p>In my solution for this task, however, I’m not going to use <code>pivot_longer()</code> for a couple of reasons. First, it’s an opportunity for us to learn about the special use of dot (<code>.</code>) inside of <code>dplyr</code> verbs. Second, my solution will use <code>dplyr</code> only. It will not require us to use the <code>tidyr</code> package.</p>
<p>Before we talk about the dot, however, let’s make sure we know what the <code>names()[1]</code> is doing. There aren’t any new concepts here, but we may not have used them this way before. The <code>name()</code> function just returns a character vector containing the column names of the data frame we pass to it. So, when we pass the <code>cat_stats</code> data frame to it, this is what it returns:</p>
<div class="sourceCode" id="cb1470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1470-1"><a href="writing-for-loops.html#cb1470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cat_stats)</span></code></pre></div>
<pre><code>## [1] &quot;age_group&quot; &quot;n&quot;</code></pre>
<p>We want to use the first value, <code>"age_group"</code> to fill-in our the new <code>variable</code> column we want to create. We can use bracket notation to subset the first element of the character vector of column names above like this:</p>
<div class="sourceCode" id="cb1472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1472-1"><a href="writing-for-loops.html#cb1472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cat_stats)[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] &quot;age_group&quot;</code></pre>
<p>What does the dot do? Well, outside of our <code>dplyr</code> pipeline, it doesn’t do anything useful:</p>
<div class="sourceCode" id="cb1474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1474-1"><a href="writing-for-loops.html#cb1474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(.)[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;.&#39; not found</code></pre>
<p><em>Inside</em> of our <code>dplyr</code> pipeline, you can think of it as a placeholder for whatever is getting passed to the <code>dplyr</code> verb – <code>mutate()</code> in this case. So, what is getting passed to mutate? The result of everything that comes before <code>mutate()</code> in the pipeline. And what does that result look like in this case? It looks like this:</p>
<div class="sourceCode" id="cb1476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1476-1"><a href="writing-for-loops.html#cb1476-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1476-2"><a href="writing-for-loops.html#cb1476-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   age_group           n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Younger than 30    56
## 2 30 and Older       11
## 3 &lt;NA&gt;                1</code></pre>
<p>So, we can use the dot inside of mutate as a substitute for the results data frame getting passed to <code>mutate()</code>. Said another way. To <code>dplyr</code>, this:</p>
<div class="sourceCode" id="cb1478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1478-1"><a href="writing-for-loops.html#cb1478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(study <span class="sc">%&gt;%</span> <span class="fu">count</span>(age_group))</span></code></pre></div>
<p>and this:</p>
<div class="sourceCode" id="cb1479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1479-1"><a href="writing-for-loops.html#cb1479-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span> <span class="fu">names</span>(.)</span></code></pre></div>
<p>are the exact same thing in this context:</p>
<div class="sourceCode" id="cb1480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1480-1"><a href="writing-for-loops.html#cb1480-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1480-2"><a href="writing-for-loops.html#cb1480-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb1480-3"><a href="writing-for-loops.html#cb1480-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb1480-4"><a href="writing-for-loops.html#cb1480-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   age_group           n variable 
##   &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;    
## 1 Younger than 30    56 age_group
## 2 30 and Older       11 age_group
## 3 &lt;NA&gt;                1 age_group</code></pre>
<p>Now, we have all the variables we wanted for our final results table. Keep in mind, however, that we will eventually be stacking similar results from our other variables (i.e., <code>gender</code> and <code>bmi_3cat</code>) below these results using <code>bind_rows()</code>. You may remember from the <a href="working-with-multiple-data-frames.html#combining-data-frames-vertically-adding-rows">chapter on working with multiple data frames</a> that the <code>bind_rows()</code> function matches columns together by <em>name</em>, not by position. So, we need to change the <code>age_group</code> column name to <code>category</code>. If we don’t, we will end up with something that looks like this:</p>
<div class="sourceCode" id="cb1482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1482-1"><a href="writing-for-loops.html#cb1482-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1482-2"><a href="writing-for-loops.html#cb1482-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb1482-3"><a href="writing-for-loops.html#cb1482-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(study <span class="sc">%&gt;%</span> <span class="fu">count</span>(gender))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   age_group           n gender
##   &lt;fct&gt;           &lt;int&gt; &lt;fct&gt; 
## 1 Younger than 30    56 &lt;NA&gt;  
## 2 30 and Older       11 &lt;NA&gt;  
## 3 &lt;NA&gt;                1 &lt;NA&gt;  
## 4 &lt;NA&gt;               43 Female
## 5 &lt;NA&gt;               24 Male  
## 6 &lt;NA&gt;                1 &lt;NA&gt;</code></pre>
<p>Not what we want, right? Again, if we were doing this analysis one variable at a time, our code might look like this:</p>
<div class="sourceCode" id="cb1484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1484-1"><a href="writing-for-loops.html#cb1484-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1484-2"><a href="writing-for-loops.html#cb1484-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb1484-3"><a href="writing-for-loops.html#cb1484-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1484-4"><a href="writing-for-loops.html#cb1484-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb1484-5"><a href="writing-for-loops.html#cb1484-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   category            n variable 
##   &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;    
## 1 Younger than 30    56 age_group
## 2 30 and Older       11 age_group
## 3 &lt;NA&gt;                1 age_group</code></pre>
<p>We used the <code>rename()</code> function above to change the name of the first column from <code>age_group</code> to <code>category</code>. Remember, the syntax for renaming columns with the <code>rename()</code> function is <code>new_name = old_name</code>. But, inside our for loop we will actually have 3 old names, right? In the first iteration <code>old_name</code> will be <code>age_group</code>, in the second iteration <code>old_name</code> will be <code>gender</code>, and in the third iteration <code>old_name</code> will be <code>bmi_cat</code>. We could loop over the names, but there’s an even easier solution. Instead of asking <code>rename()</code> to rename our column by name using this syntax, <code>new_name = old_name</code>, we can also ask <code>rename()</code> to rename our column by <em>position</em> using this syntax, <code>new_name = column_number</code>. So, in our example above, we could get the same result by replacing <code>age_group</code> with <code>1</code> because <code>age_group</code> is the first column in the data frame:</p>
<div class="sourceCode" id="cb1486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1486-1"><a href="writing-for-loops.html#cb1486-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1486-2"><a href="writing-for-loops.html#cb1486-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span> </span>
<span id="cb1486-3"><a href="writing-for-loops.html#cb1486-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1486-4"><a href="writing-for-loops.html#cb1486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># Replace age_group with 1</span></span>
<span id="cb1486-5"><a href="writing-for-loops.html#cb1486-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   category            n variable 
##   &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;    
## 1 Younger than 30    56 age_group
## 2 30 and Older       11 age_group
## 3 &lt;NA&gt;                1 age_group</code></pre>
<p>And, using this method, we don’t have to make any changes to the value being passed to <code>rename()</code> when we are analyzing our other variables. For example:</p>
<div class="sourceCode" id="cb1488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1488-1"><a href="writing-for-loops.html#cb1488-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1488-2"><a href="writing-for-loops.html#cb1488-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span> <span class="co"># Changed the column from age_group to gender</span></span>
<span id="cb1488-3"><a href="writing-for-loops.html#cb1488-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1488-4"><a href="writing-for-loops.html#cb1488-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># Still have 1 here</span></span>
<span id="cb1488-5"><a href="writing-for-loops.html#cb1488-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   category     n variable
##   &lt;fct&gt;    &lt;int&gt; &lt;chr&gt;   
## 1 Female      43 gender  
## 2 Male        24 gender  
## 3 &lt;NA&gt;         1 gender</code></pre>
<p>At this point, we have all the elements we need manually create the data frame of final results we want. First, we create the empty results table:</p>
<div class="sourceCode" id="cb1490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1490-1"><a href="writing-for-loops.html#cb1490-1" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1490-2"><a href="writing-for-loops.html#cb1490-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1490-3"><a href="writing-for-loops.html#cb1490-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1490-4"><a href="writing-for-loops.html#cb1490-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n        =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb1490-5"><a href="writing-for-loops.html#cb1490-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1490-6"><a href="writing-for-loops.html#cb1490-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 0 × 3
## # … with 3 variables: variable &lt;chr&gt;, category &lt;chr&gt;, n &lt;dbl&gt;</code></pre>
<p>Then, we get the data frame of results for <code>age_group</code>:</p>
<div class="sourceCode" id="cb1492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1492-1"><a href="writing-for-loops.html#cb1492-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1492-2"><a href="writing-for-loops.html#cb1492-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group) <span class="sc">%&gt;%</span></span>
<span id="cb1492-3"><a href="writing-for-loops.html#cb1492-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1492-4"><a href="writing-for-loops.html#cb1492-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1492-5"><a href="writing-for-loops.html#cb1492-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   category            n variable 
##   &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;    
## 1 Younger than 30    56 age_group
## 2 30 and Older       11 age_group
## 3 &lt;NA&gt;                1 age_group</code></pre>
<p>Then, we use <code>bind_rows()</code> to add those results to our <code>cat_table</code> data frame:</p>
<div class="sourceCode" id="cb1494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1494-1"><a href="writing-for-loops.html#cb1494-1" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> cat_table <span class="sc">%&gt;%</span> </span>
<span id="cb1494-2"><a href="writing-for-loops.html#cb1494-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(cat_stats) <span class="sc">%&gt;%</span> </span>
<span id="cb1494-3"><a href="writing-for-loops.html#cb1494-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   variable  category            n
##   &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
## 1 age_group Younger than 30    56
## 2 age_group 30 and Older       11
## 3 age_group &lt;NA&gt;                1</code></pre>
<p>Then, we copy and paste the last two steps above, replacing <code>age_group</code> with <code>gender</code>:</p>
<div class="sourceCode" id="cb1496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1496-1"><a href="writing-for-loops.html#cb1496-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1496-2"><a href="writing-for-loops.html#cb1496-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span> <span class="co"># Change to gender</span></span>
<span id="cb1496-3"><a href="writing-for-loops.html#cb1496-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1496-4"><a href="writing-for-loops.html#cb1496-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1496-5"><a href="writing-for-loops.html#cb1496-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1496-6"><a href="writing-for-loops.html#cb1496-6" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> cat_table <span class="sc">%&gt;%</span> </span>
<span id="cb1496-7"><a href="writing-for-loops.html#cb1496-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(cat_stats) <span class="sc">%&gt;%</span> </span>
<span id="cb1496-8"><a href="writing-for-loops.html#cb1496-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   variable  category            n
##   &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
## 1 age_group Younger than 30    56
## 2 age_group 30 and Older       11
## 3 age_group &lt;NA&gt;                1
## 4 gender    Female             43
## 5 gender    Male               24
## 6 gender    &lt;NA&gt;                1</code></pre>
<p>Then, we copy and paste the two steps above, replacing <code>gender</code> with <code>bmi_3cat</code>:</p>
<div class="sourceCode" id="cb1498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1498-1"><a href="writing-for-loops.html#cb1498-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1498-2"><a href="writing-for-loops.html#cb1498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(bmi_3cat) <span class="sc">%&gt;%</span>  <span class="co"># Change to bmi_3cat</span></span>
<span id="cb1498-3"><a href="writing-for-loops.html#cb1498-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1498-4"><a href="writing-for-loops.html#cb1498-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1498-5"><a href="writing-for-loops.html#cb1498-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1498-6"><a href="writing-for-loops.html#cb1498-6" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> cat_table <span class="sc">%&gt;%</span> </span>
<span id="cb1498-7"><a href="writing-for-loops.html#cb1498-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(cat_stats) <span class="sc">%&gt;%</span> </span>
<span id="cb1498-8"><a href="writing-for-loops.html#cb1498-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>That is exactly the final result we wanted, and I’m sure you noticed that the only elements of the code chunks above that changed were the column names being passed to <code>count()</code>. If we can just figure out how to loop over the column names, then we can remove a ton of unnecessary repetition from our code. Our first attempt might look like this:</p>
<div class="sourceCode" id="cb1500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1500-1"><a href="writing-for-loops.html#cb1500-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(age_group, gender, bmi_3cat)) {</span>
<span id="cb1500-2"><a href="writing-for-loops.html#cb1500-2" aria-hidden="true" tabindex="-1"></a>  study <span class="sc">%&gt;%</span> </span>
<span id="cb1500-3"><a href="writing-for-loops.html#cb1500-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(i) <span class="sc">%&gt;%</span> </span>
<span id="cb1500-4"><a href="writing-for-loops.html#cb1500-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1500-5"><a href="writing-for-loops.html#cb1500-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1500-6"><a href="writing-for-loops.html#cb1500-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;age_group&#39; not found</code></pre>
<p>However, it doesn’t work. In the code above, R is looking for and <em>object</em> in the global environment called <code>age_group</code>. Of course, there is no object in the global environment named <code>age_group</code>. Rather, there is an object in the global environment named <code>study</code> that has a column named <code>age_group</code>.</p>
<p>We can get rid of that error by wrapping each column name in quotes:</p>
<div class="sourceCode" id="cb1502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1502-1"><a href="writing-for-loops.html#cb1502-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1502-2"><a href="writing-for-loops.html#cb1502-2" aria-hidden="true" tabindex="-1"></a>  study <span class="sc">%&gt;%</span> </span>
<span id="cb1502-3"><a href="writing-for-loops.html#cb1502-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(i) <span class="sc">%&gt;%</span> </span>
<span id="cb1502-4"><a href="writing-for-loops.html#cb1502-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1502-5"><a href="writing-for-loops.html#cb1502-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1502-6"><a href="writing-for-loops.html#cb1502-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error: Must group by variables found in `.data`.
## * Column `i` is not found.</code></pre>
<p>Unfortunately, that just gives us a different error. In the code above, <code>count()</code> is looking for a column named <code>i</code> in the <code>study</code> data frame. You may be wondering why <code>i</code> is not being converted to <code>"age_group"</code>, <code>"gender"</code>, and <code>"bmi_3cat"</code> in the code above. The short answer is that it’s because of <a href="introduction-to-repeated-operations.html#tidy-evaluation">tidy evaluation and data masking</a>.</p>
<p>So, we need a way to iteratively pass each quoted column name to the <code>count()</code> function inside our for loop body, but also let <code>dplyr</code> know that they <em>are column names</em>, not just random character strings. Fortunately, the <code>rlang</code> package (which is partially imported with <code>dplyr</code>), provides us with a special construct that can help us solve this problem. It’s called the <code>.data</code> pronoun. Here’s how we can use it:</p>
<div class="sourceCode" id="cb1504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1504-1"><a href="writing-for-loops.html#cb1504-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1504-2"><a href="writing-for-loops.html#cb1504-2" aria-hidden="true" tabindex="-1"></a>  study <span class="sc">%&gt;%</span> </span>
<span id="cb1504-3"><a href="writing-for-loops.html#cb1504-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span> </span>
<span id="cb1504-4"><a href="writing-for-loops.html#cb1504-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1504-5"><a href="writing-for-loops.html#cb1504-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1504-6"><a href="writing-for-loops.html#cb1504-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span>
<span id="cb1504-7"><a href="writing-for-loops.html#cb1504-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   category            n variable 
##   &lt;fct&gt;           &lt;int&gt; &lt;chr&gt;    
## 1 Younger than 30    56 age_group
## 2 30 and Older       11 age_group
## 3 &lt;NA&gt;                1 age_group
## # A tibble: 3 × 3
##   category     n variable
##   &lt;fct&gt;    &lt;int&gt; &lt;chr&gt;   
## 1 Female      43 gender  
## 2 Male        24 gender  
## 3 &lt;NA&gt;         1 gender  
## # A tibble: 4 × 3
##   category       n variable
##   &lt;fct&gt;      &lt;int&gt; &lt;chr&gt;   
## 1 Normal        43 bmi_3cat
## 2 Overweight    16 bmi_3cat
## 3 Obese          5 bmi_3cat
## 4 &lt;NA&gt;           4 bmi_3cat</code></pre>
<p>Here’s how it works. Remember that data masking allows us to write column names directly in <code>dplyr</code> code without having to use dollar sign or bracket notation to tell R which data frame that column lives in. For example, in the following code, <code>dplyr</code> just “knows” that <code>age_group</code> is a column in the <code>study</code> data frame:</p>
<div class="sourceCode" id="cb1506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1506-1"><a href="writing-for-loops.html#cb1506-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1506-2"><a href="writing-for-loops.html#cb1506-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(age_group)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   age_group           n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Younger than 30    56
## 2 30 and Older       11
## 3 &lt;NA&gt;                1</code></pre>
<p>The same is not true for base R functions. For example, we can’t pass <code>age_group</code> directly to the <code>table()</code> function:</p>
<div class="sourceCode" id="cb1508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1508-1"><a href="writing-for-loops.html#cb1508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(age_group)</span></code></pre></div>
<pre><code>## Error in table(age_group): object &#39;age_group&#39; not found</code></pre>
<p>We have to use dollar sign or bracket notation to tell R that <code>age_group</code> is a column in <code>study</code>:</p>
<div class="sourceCode" id="cb1510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1510-1"><a href="writing-for-loops.html#cb1510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(study[[<span class="st">&quot;age_group&quot;</span>]])</span></code></pre></div>
<pre><code>## 
## Younger than 30    30 and Older 
##              56              11</code></pre>
<p>This is a really nice feature of <code>dplyr</code> when we’re using dplyr interactively. But, as we’ve already discussed, it does present us with some challenges when we use <code>dplyr</code> functions inside of the functions we write ourselves and inside of for loops.</p>
<p>As you can see in the code below, the tidy evaluation essentially blocks the <code>i</code> inside of <code>count()</code> from being replaced with each of the character strings we are looping over. Instead, <code>dplyr</code> looks for a literal <code>i</code> as a column name in the <code>study</code> data frame.</p>
<div class="sourceCode" id="cb1512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1512-1"><a href="writing-for-loops.html#cb1512-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1512-2"><a href="writing-for-loops.html#cb1512-2" aria-hidden="true" tabindex="-1"></a>  study <span class="sc">%&gt;%</span> </span>
<span id="cb1512-3"><a href="writing-for-loops.html#cb1512-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(i)</span>
<span id="cb1512-4"><a href="writing-for-loops.html#cb1512-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error: Must group by variables found in `.data`.
## * Column `i` is not found.</code></pre>
<p>So, we need a way to tell <code>dplyr</code> that <code>"age_group"</code> is a column <em>in</em> the <code>study</code> data frame. Well, we know how to use quoted column names inside bracket notation. So, we could write code like this:</p>
<div class="sourceCode" id="cb1514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1514-1"><a href="writing-for-loops.html#cb1514-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1514-2"><a href="writing-for-loops.html#cb1514-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(study[[<span class="st">&quot;age_group&quot;</span>]])</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   `study[[&quot;age_group&quot;]]`     n
##   &lt;fct&gt;                  &lt;int&gt;
## 1 Younger than 30           56
## 2 30 and Older              11
## 3 &lt;NA&gt;                       1</code></pre>
<p>However, the column name (i.e., <code>study[["age_group"]]</code>) in the results data frame above isn’t ideal to work with. Additionally, the code above isn’t very flexible because we have the <code>study</code> data frame hard-coded into it (i.e., <code>study[["age_group"]]</code>). That’s where the <code>.data</code> pronoun comes to the rescue:</p>
<div class="sourceCode" id="cb1516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1516-1"><a href="writing-for-loops.html#cb1516-1" aria-hidden="true" tabindex="-1"></a>study <span class="sc">%&gt;%</span> </span>
<span id="cb1516-2"><a href="writing-for-loops.html#cb1516-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(.data[[<span class="st">&quot;age_group&quot;</span>]])</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   age_group           n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Younger than 30    56
## 2 30 and Older       11
## 3 &lt;NA&gt;                1</code></pre>
<p>The <code>.data</code> pronoun “is not a data frame; it’s a special construct, a pronoun, that allows you to access the current variables either directly, with .data$x or indirectly with .data[[var]].”<span class="citation"><sup><a href="#ref-Wickham2020-dx" role="doc-biblioref">6</a></sup></span></p>
<p>When we put it all together, our code looks like this:</p>
<div class="sourceCode" id="cb1518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1518-1"><a href="writing-for-loops.html#cb1518-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame structure that will contain our results</span></span>
<span id="cb1518-2"><a href="writing-for-loops.html#cb1518-2" aria-hidden="true" tabindex="-1"></a>cat_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1518-3"><a href="writing-for-loops.html#cb1518-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1518-4"><a href="writing-for-loops.html#cb1518-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1518-5"><a href="writing-for-loops.html#cb1518-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n        =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb1518-6"><a href="writing-for-loops.html#cb1518-6" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb1518-7"><a href="writing-for-loops.html#cb1518-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1518-8"><a href="writing-for-loops.html#cb1518-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For each column, get the column name, category names, and count.</span></span>
<span id="cb1518-9"><a href="writing-for-loops.html#cb1518-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, add them to the bottom of the results data frame we created above.</span></span>
<span id="cb1518-10"><a href="writing-for-loops.html#cb1518-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)) {</span>
<span id="cb1518-11"><a href="writing-for-loops.html#cb1518-11" aria-hidden="true" tabindex="-1"></a>  cat_stats <span class="ot">&lt;-</span> study <span class="sc">%&gt;%</span> </span>
<span id="cb1518-12"><a href="writing-for-loops.html#cb1518-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span> <span class="co"># Use .data to refer to the current data frame.</span></span>
<span id="cb1518-13"><a href="writing-for-loops.html#cb1518-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="co"># Use . to refer to the current data frame.</span></span>
<span id="cb1518-14"><a href="writing-for-loops.html#cb1518-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1518-15"><a href="writing-for-loops.html#cb1518-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1518-16"><a href="writing-for-loops.html#cb1518-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here is where we update cat_table with the results for each column</span></span>
<span id="cb1518-17"><a href="writing-for-loops.html#cb1518-17" aria-hidden="true" tabindex="-1"></a>  cat_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cat_table, cat_stats)</span>
<span id="cb1518-18"><a href="writing-for-loops.html#cb1518-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1519-1"><a href="writing-for-loops.html#cb1519-1" aria-hidden="true" tabindex="-1"></a>cat_table</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>And, we can do other interesting things with our results now that we have it in this format. For example, we can easily add percentages along with our counts like this:</p>
<div class="sourceCode" id="cb1521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1521-1"><a href="writing-for-loops.html#cb1521-1" aria-hidden="true" tabindex="-1"></a>cat_table <span class="sc">%&gt;%</span> </span>
<span id="cb1521-2"><a href="writing-for-loops.html#cb1521-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span> </span>
<span id="cb1521-3"><a href="writing-for-loops.html#cb1521-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1521-4"><a href="writing-for-loops.html#cb1521-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1521-5"><a href="writing-for-loops.html#cb1521-5" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
## # Groups:   variable [3]
##    variable  category            n percent
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;
##  1 age_group Younger than 30    56   82.4 
##  2 age_group 30 and Older       11   16.2 
##  3 age_group &lt;NA&gt;                1    1.47
##  4 gender    Female             43   63.2 
##  5 gender    Male               24   35.3 
##  6 gender    &lt;NA&gt;                1    1.47
##  7 bmi_3cat  Normal             43   63.2 
##  8 bmi_3cat  Overweight         16   23.5 
##  9 bmi_3cat  Obese               5    7.35
## 10 bmi_3cat  &lt;NA&gt;                4    5.88</code></pre>
<p>Finally, we could also write our own function that uses the code above. That way, we can easily reuse this code in the future:</p>
<div class="sourceCode" id="cb1523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1523-1"><a href="writing-for-loops.html#cb1523-1" aria-hidden="true" tabindex="-1"></a>cat_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ...) {</span>
<span id="cb1523-2"><a href="writing-for-loops.html#cb1523-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the data frame structure that will contain our results</span></span>
<span id="cb1523-3"><a href="writing-for-loops.html#cb1523-3" aria-hidden="true" tabindex="-1"></a>  cat_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1523-4"><a href="writing-for-loops.html#cb1523-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1523-5"><a href="writing-for-loops.html#cb1523-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">category =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>), </span>
<span id="cb1523-6"><a href="writing-for-loops.html#cb1523-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n        =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>)</span>
<span id="cb1523-7"><a href="writing-for-loops.html#cb1523-7" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb1523-8"><a href="writing-for-loops.html#cb1523-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1523-9"><a href="writing-for-loops.html#cb1523-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For each column in ..., get the column name, category names, and count.</span></span>
<span id="cb1523-10"><a href="writing-for-loops.html#cb1523-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then, add them to the bottom of the results data frame we created above.</span></span>
<span id="cb1523-11"><a href="writing-for-loops.html#cb1523-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(...)) {</span>
<span id="cb1523-12"><a href="writing-for-loops.html#cb1523-12" aria-hidden="true" tabindex="-1"></a>    stats <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1523-13"><a href="writing-for-loops.html#cb1523-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">count</span>(.data[[i]]) <span class="sc">%&gt;%</span> <span class="co"># Use .data to refer to the current data frame.</span></span>
<span id="cb1523-14"><a href="writing-for-loops.html#cb1523-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">names</span>(.)[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> <span class="co"># Use . to refer to the current data frame.</span></span>
<span id="cb1523-15"><a href="writing-for-loops.html#cb1523-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">category =</span> <span class="dv">1</span>)</span>
<span id="cb1523-16"><a href="writing-for-loops.html#cb1523-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1523-17"><a href="writing-for-loops.html#cb1523-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Here is where we update cat_table with the results for each column</span></span>
<span id="cb1523-18"><a href="writing-for-loops.html#cb1523-18" aria-hidden="true" tabindex="-1"></a>    cat_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cat_table, stats)</span>
<span id="cb1523-19"><a href="writing-for-loops.html#cb1523-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1523-20"><a href="writing-for-loops.html#cb1523-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return results</span></span>
<span id="cb1523-21"><a href="writing-for-loops.html#cb1523-21" aria-hidden="true" tabindex="-1"></a>  cat_table</span>
<span id="cb1523-22"><a href="writing-for-loops.html#cb1523-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb1524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1524-1"><a href="writing-for-loops.html#cb1524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat_stats</span>(study, <span class="st">&quot;age_group&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;bmi_3cat&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    variable  category            n
##    &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
##  1 age_group Younger than 30    56
##  2 age_group 30 and Older       11
##  3 age_group &lt;NA&gt;                1
##  4 gender    Female             43
##  5 gender    Male               24
##  6 gender    &lt;NA&gt;                1
##  7 bmi_3cat  Normal             43
##  8 bmi_3cat  Overweight         16
##  9 bmi_3cat  Obese               5
## 10 bmi_3cat  &lt;NA&gt;                4</code></pre>
<p>We covered a lot of material in this chapter. For loops tend to be confusing for people who are just learning to program. When you throw in the tidy evaluation stuff, it can be really confusing – even for experienced R programmers. So, if you are still feeling a little confused, don’t beat yourself up. Also, I don’t recommend trying to memorize everything we covered in this chapter. Instead, I recommend that you read it until you have understood what for loops are and when they might be useful at a high level. Then, refer back to this chapter (or other online references that discuss for loops) if you find yourself in a situation where you believe that for loops might be the right tool to help you complete a given programming task. Having said that, also keep in mind that for loops are rarely the <em>only</em> tool you will have at your disposal to complete the task. In the next chapter, we will learn how to use functionals, specifically the <code>purrr</code> package, in place of for loops. You may find this approach to iteration more intuitive.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Wickham2020-dx" class="csl-entry">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Wickham H, François R, Henry L, Müller K, RStudio. <em>Programming with Dplyr</em>.; 2020.</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="column-wise-operations-in-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-the-purrr-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/brad-cannell/r4epi/edit/master/chapters/07_part_repeated_operations/04_writing_for_loops.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
